"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["2569"],{870:function(n,e,s){s.r(e),s.d(e,{default:()=>h});var i=s(2676),l=s(453);function r(n){let e=Object.assign({h1:"h1",a:"a",h2:"h2",p:"p",pre:"pre",code:"code",img:"img",ul:"ul",li:"li"},(0,l.ah)(),n.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(e.h1,{id:"jenkins环境搭建以及任务创建",children:["Jenkins环境搭建以及任务创建",(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#jenkins环境搭建以及任务创建",children:"#"})]}),"\n",(0,i.jsxs)(e.h2,{id:"环境搭建",children:["环境搭建",(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#环境搭建",children:"#"})]}),"\n",(0,i.jsx)(e.p,{children:"下面主要讲解一下利用Jenkins容器搭建Jenkins环境"}),"\n",(0,i.jsx)(e.p,{children:"1、下载kenkins容器镜像(建议下载lts稳定版本)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"docker pull Jenkins/Jenkins:lts\n"})}),"\n",(0,i.jsx)(e.p,{children:"2、创建docker的文件影射卷"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"docker volume inspect Jenkins_zuo\n"})}),"\n",(0,i.jsx)(e.p,{children:"3、运行容器"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"docker run -d --name Jenkins_rongqi -p 8080:8080 -p 50000:50000 -v \nJenkins_zuo:/var/Jenkins_home Jenkins/Jenkins:lts\n"})}),"\n",(0,i.jsx)(e.p,{children:"8080端口是Jenkins对外服务开放的端口"}),"\n",(0,i.jsx)(e.p,{children:"50000端口是slave节点与Jenkins的通讯端口"}),"\n",(0,i.jsx)(e.p,{children:"4、查看容器启动日志，查看Jenkins的初始密码"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"docker exec Jenkins_rongqi cat /var/Jenkins_home/secrets/initialAdminPassword\n"})}),"\n",(0,i.jsx)(e.p,{children:"5、通过web端8080端口，访问Jenkins登录页面，使用初始密码可以成功登录"}),"\n",(0,i.jsx)(e.p,{children:"6、进入插件选择页面，选择自己想要使用的插件"}),"\n",(0,i.jsx)(e.p,{children:"7、创建用户，创建Jenkins URL等基础配置，Jenkins安装完成"}),"\n",(0,i.jsxs)(e.h2,{id:"任务创建",children:["任务创建",(0,i.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#任务创建",children:"#"})]}),"\n",(0,i.jsx)(e.p,{children:"1、入口"}),"\n",(0,i.jsx)(e.p,{children:'(1) 点击"新建Item"按钮，进入任务创建页面'}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"/Jenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA_assets/%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA.png",alt:"任务创建"})}),"\n",(0,i.jsx)(e.p,{children:"(2)可以选择创建一个新的任务，输入任务名称，选择任务类型，点击确定即可，也可以选择复制一个现有的任务，输入任务名称，填入想要复制的任务路径，点击确定"}),"\n",(0,i.jsx)(e.p,{children:"2、任务设置"}),"\n",(0,i.jsx)(e.p,{children:"这里以'Freestyle project'类型任务进行举例"}),"\n",(0,i.jsx)(e.p,{children:"(1)通用模块设置"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"填写项目的描述信息"}),"\n"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"设置用户权限"}),"\n"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"项目重构：重新构建这个作业而不需要再次输入参数，也就是说，它会使用上一次构建时使用的参数值直接进行构建"}),"\n"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"任务构建参数选择："}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"添加一些参数变量信息到你的Jenkins工程当中，根据参数类型，每个参数都有一个Name和某种类型的Value。当构建开始时，这些名称-值对将作为环境变量导出，允许构建配置的后续部分(例如构建步骤)访问这些值，例如通过使用${PARAMETER_NAME}语法使用这些变量"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"禁止重构，勾选后，任务将不支持重构功能"}),"\n"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"限制job的最大并发数量"}),"\n"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"允许项目并发执行"}),"\n"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"限制job的运行环境，填写slave节点的标签即可"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"(2)源码管理模块"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"设置要在任务中要使用的代码仓"}),"\n",(0,i.jsx)(e.p,{children:"Repository URL：代码仓库地址"}),"\n",(0,i.jsx)(e.p,{children:"Credentials:ssh私钥，用于免密clone仓库"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"仓库分支设置"}),"\n",(0,i.jsx)(e.p,{children:"指定分支：clone仓库的哪个分支"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"添加仓库附加行为"}),"\n",(0,i.jsx)(e.p,{children:"根据你使用的版本控制系统，选择一个或多个附加行为。以下是一些常见的 Git 附加行为："}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Check out to a sub-directory: 将检出代码放到一个子目录中"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Clean before checkout: 在每次检出之前清理工作区，确保不会有遗留的文件"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Prune stale remote-tracking branches: 清理不再存在的远程分支的跟踪记录"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Advanced clone behaviours: 配置高级克隆选项，如 --depth、--single-branch 等"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"(3)构建触发器模块"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"任务构建设置"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"触发远程构建：当想要利用脚本远程触发Jenkins任务的时候，可以选择此选项"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"假如此处勾选了此选项，设置一个token值，用于远程控制任务，我们可以通过python的第三方库python-Jenkins进行任务的构建，日志查看等操作，下面是一个简单的demo"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"import Jenkins\nurl = 'http://Jenkinswh.uniontech.com/Jenkinsb/job/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7'\nusername = 'ut005046'\npassword = 'jiubugaosuni'\njk = Jenkins.Jenkins(url=url, username=username, password=password, timeout=20)\njk.build_job(name='test_zz', parameters={'kernel': '4.19'}, token='zuohanxu')\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Build periodically：定时触发Jenkins任务，如下，每周的星期五中午 12 点执行任务：H 12 * * 5"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Poll SCM：用于设置 Jenkins 任务如何定期检查源码管理系统（SCM）以检测代码更改。如果检测到更改，Jenkins 将自动触发构建，如设置为H/15 * * * *，则会15分钟检查一次代码变更情况"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Build after other projects are built：用于配置当前项目在其他项目完成构建后进行构建"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"(4)构建模块"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"点击“增加构建步骤”，可以选择构建的方式，最常见的是Excute shell,可以通过shell命令，进行相关build操作"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"(5)构建后操作模块"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"build完成后，进行的一系列操作，比如说，可以将测试结果通过企业微信发送至项目负责人"}),"\n"]})]})}function c(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,l.ah)(),n.components);return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(r,{...n})}):r(n)}let h=c;c.__RSPRESS_PAGE_META={},c.__RSPRESS_PAGE_META["%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80%2FJenkins%2FJenkins%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA.md"]={toc:[{text:"环境搭建",id:"环境搭建",depth:2},{text:"任务创建",id:"任务创建",depth:2}],title:"Jenkins环境搭建以及任务创建",headingTitle:"Jenkins环境搭建以及任务创建",frontmatter:{Author:"zhx"}}}}]);