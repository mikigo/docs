"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["5215"],{9126:function(e,i,r){r.r(i),r.d(i,{default:()=>l});var n=r(2676),s=r(453);function d(e){let i=Object.assign({h1:"h1",a:"a",h2:"h2",code:"code",pre:"pre",h3:"h3",p:"p",strong:"strong"},(0,s.ah)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i.h1,{id:"kvm安装配置及使用说明",children:["KVM安装配置及使用说明",(0,n.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#kvm安装配置及使用说明",children:"#"})]}),"\n",(0,n.jsxs)(i.h2,{id:"一安装-kvm",children:["一、安装 ",(0,n.jsx)(i.code,{children:"KVM"}),(0,n.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#一安装-kvm",children:"#"})]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-shell",children:"sudo apt install -y libvirt0 libvirt-daemon qemu virt-manager bridge-utils libvirt-clients python-libvirt qemu-efi uml-utilities virtinst qemu-system\n"})}),"\n",(0,n.jsxs)(i.h2,{id:"二命令安装镜像",children:["二、命令安装镜像",(0,n.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#二命令安装镜像",children:"#"})]}),"\n",(0,n.jsxs)(i.h3,{id:"1创建存储卷",children:["1、创建存储卷",(0,n.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#1创建存储卷",children:"#"})]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-shell",children:"mkdir -p work/kvm;qemu-img create -f qcow2 /home/uos/work/kvm/autotest1.qcow2 80G\n"})}),"\n",(0,n.jsxs)(i.h3,{id:"2创建虚拟机",children:["2、创建虚拟机",(0,n.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#2创建虚拟机",children:"#"})]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-shell",children:'virt-install \\\n--name autotest1 \\\n--memory 2048 \\\n--vcpus 1 \\\n--disk /home/uos/work/kvm/autotest1.qcow2,device=disk,bus=virtio \\\n--os-type=linux \\\n--os-variant debian10 \\\n--graphics spice \\\n--noreboot \\\n--boot hd \\\n--cdrom  "/home/uos/Desktop/test.iso" \\\n--connect qemu:///system \\\n--network type=direct,source=enp5s0f0,source_mode=bridge\n'})}),"\n",(0,n.jsxs)(i.h2,{id:"三配置远程管理",children:["三、配置远程管理",(0,n.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#三配置远程管理",children:"#"})]}),"\n",(0,n.jsxs)(i.h3,{id:"1增加-libvirtd-用户组",children:["1、增加 ",(0,n.jsx)(i.code,{children:"libvirtd"})," 用户组",(0,n.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#1增加-libvirtd-用户组",children:"#"})]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-shell",children:"groupadd libvirtd\n"})}),"\n",(0,n.jsxs)(i.h3,{id:"2设置用户到组",children:["2、设置用户到组",(0,n.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#2设置用户到组",children:"#"})]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-shell",children:"sudo usermod -a -G libvirtd $USER\n"})}),"\n",(0,n.jsxs)(i.h3,{id:"3设置启动libvirtd服务的用户组",children:["3、设置启动libvirtd服务的用户组",(0,n.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#3设置启动libvirtd服务的用户组",children:"#"})]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-shell",children:"sudo vi /etc/libvirt/libvirtd.conf\n"})}),"\n",(0,n.jsx)(i.p,{children:"在尾行写入"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-shell",children:'unix_sock_group = "libvirtd"\n'})}),"\n",(0,n.jsxs)(i.h3,{id:"4增加权限启动配置",children:["4、增加权限启动配置",(0,n.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#4增加权限启动配置",children:"#"})]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-shell",children:"sudo vi /etc/polkit-1/localauthority/50-local.d/50-org.libvirtd-group-access.pkla\n"})}),"\n",(0,n.jsx)(i.p,{children:"写入"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-shell",children:"[libvirtd group Management Access]\nIdentity=unix-group:libvirtd\nAction=org.libvirt.unix.manage\nResultAny=yes\nResultInactive=yes\nResultActive=yes\n"})}),"\n",(0,n.jsxs)(i.h3,{id:"5重启服务",children:["5、重启服务",(0,n.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#5重启服务",children:"#"})]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-shell",children:"sudo service libvirtd restart\n"})}),"\n",(0,n.jsxs)(i.h2,{id:"四常见问题",children:["四、常见问题",(0,n.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#四常见问题",children:"#"})]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.strong,{children:"1、Requested operation is not valid: network 'default' is not active"})}),"\n",(0,n.jsx)(i.p,{children:"解决方案："}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-shell",children:"sudo virsh net-start default\nsudo virsh net-autostart default\n"})})]})}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:i}=Object.assign({},(0,s.ah)(),e.components);return i?(0,n.jsx)(i,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}let l=a;a.__RSPRESS_PAGE_META={},a.__RSPRESS_PAGE_META["program%2FLinux%2FKVM%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E.md"]={toc:[{text:"一、安装 `KVM`",id:"一安装-kvm",depth:2},{text:"二、命令安装镜像",id:"二命令安装镜像",depth:2},{text:"1、创建存储卷",id:"1创建存储卷",depth:3},{text:"2、创建虚拟机",id:"2创建虚拟机",depth:3},{text:"三、配置远程管理",id:"三配置远程管理",depth:2},{text:"1、增加 `libvirtd` 用户组",id:"1增加-libvirtd-用户组",depth:3},{text:"2、设置用户到组",id:"2设置用户到组",depth:3},{text:"3、设置启动libvirtd服务的用户组",id:"3设置启动libvirtd服务的用户组",depth:3},{text:"4、增加权限启动配置",id:"4增加权限启动配置",depth:3},{text:"5、重启服务",id:"5重启服务",depth:3},{text:"四、常见问题",id:"四常见问题",depth:2}],title:"KVM安装配置及使用说明",headingTitle:"KVM安装配置及使用说明",frontmatter:{Author:"mikigo"}}}}]);