<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Rspress v1.43.10">
    <title data-rh="true">Shell进程调用 - mikigo`s docs</title><meta data-rh="true" name="description" content="mikigo`s docs"/>
  <script>{;const saved = localStorage.getItem('rspress-theme-appearance');const preferDark = window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = !saved || saved === 'auto' ? preferDark : saved === 'dark';document.documentElement.classList.toggle('dark', isDark);document.documentElement.style.colorScheme = isDark ? 'dark' : 'light';}</script><link rel="icon" href="/favicon.ico"><script defer src="/static/js/styles.f437f79a.js"></script><script defer src="/static/js/lib-react.7881668b.js"></script><script defer src="/static/js/lib-router.89dc1c3a.js"></script><script defer src="/static/js/4099.89dc8eb8.js"></script><script defer src="/static/js/index.0dafbfca.js"></script><link href="/static/css/styles.c63a5b8f.css" rel="stylesheet"></head>

  <body >
    <div id="root"><div class="navContainer_d18b1 rspress-nav px-6  sticky_ddfa7"><div class="container_e4235 flex justify-between items-center h-full"><div class="navBarTitle_c5f07"><a class="link_a7cea flex items-center w-full h-full text-base font-semibold transition-opacity duration-300 hover:opacity-60 cursor-pointer" target="" href="/index.html"><div class="mr-1 min-w-8"><img src="/logo.png" alt="logo" id="logo" class="rspress-logo"/></div><span>mikigo</span></a></div><div class="flex flex-1 justify-end items-center"><div class="rightNav_a2fea"><div class="flex sm:flex-1 items-center sm:pl-4 sm:pr-2"><div class="rspress-nav-search-button navSearchButton_df1fb"><button><svg width="18" height="18" viewBox="0 0 32 32"><path fill="var(--rp-c-gray)" d="m29 27.586-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29ZM4 13a9 9 0 1 1 9 9 9.01 9.01 0 0 1-9-9"></path></svg><p class="searchWord_af2c1">搜索文档</p><div style="opacity:0"><span></span><span>K</span></div></button></div><div class="mobileNavSearchButton_d85a9"><svg width="24" height="24" viewBox="0 0 32 32"><path fill="var(--rp-c-gray)" d="m29 27.586-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29ZM4 13a9 9 0 1 1 9 9 9.01 9.01 0 0 1-9-9"></path></svg></div></div><div class="rspress-nav-menu menu h-14"><a class="link_a7cea  cursor-pointer" target="" href="/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-0.5 px-3 py-2 flex items-center">🏠首页</div></a><a class="link_a7cea  cursor-pointer" target="" href="/autotest/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-0.5 px-3 py-2 flex items-center">🤖自动化技术</div></a><a class="link_a7cea  cursor-pointer" target="" href="/program/index.html"><div class="rspress-nav-menu-item singleItem_c1154 activeItem_a28b5 text-sm font-medium mx-0.5 px-3 py-2 flex items-center">💻编程基础</div></a><a class="link_a7cea  cursor-pointer" target="" href="/tech_doc/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-0.5 px-3 py-2 flex items-center">📚技术文档</div></a><a class="link_a7cea  cursor-pointer" target="" href="/blog/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-0.5 px-3 py-2 flex items-center">📋博客</div></a><a class="link_a7cea  cursor-pointer" target="" href="/cookbook/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-0.5 px-3 py-2 flex items-center">🧑‍🍳菜谱</div></a><div class="mx-3 last:mr-0"><div class="relative flex-center h-14"><button class="rspress-nav-menu-group-button flex-center items-center font-medium text-sm text-text-1 hover:text-text-2 transition-colors duration-200"><span class="text-sm font-medium flex" style="margin-right:2px">🗃️其他</span><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M16 22 6 12l1.4-1.4 8.6 8.6 8.6-8.6L26 12z"></path></svg></button><div class="rspress-nav-menu-group-content absolute mx-0.8 transition-opacity duration-300" style="opacity:0;visibility:hidden;right:0;top:52px"><div class="p-3 pr-2 w-full h-full max-h-100vh whitespace-nowrap" style="box-shadow:var(--rp-shadow-3);z-index:100;border:1px solid var(--rp-c-divider-light);border-radius:var(--rp-radius-large);background:var(--rp-c-bg)"><div><div class="font-medium my-1"><a href="https://zeng-yi.com:5000" target="_blank" rel="noopener noreferrer" class="link_a7cea "><div class="rounded-2xl hover:bg-mute" style="padding:0.4rem 1.5rem 0.4rem 0.75rem"><div class="flex"><span>My FileServer</span></div></div></a></div></div><div><div class="font-medium my-1"><a href="https://youqu.uniontech.com" target="_blank" rel="noopener noreferrer" class="link_a7cea "><div class="rounded-2xl hover:bg-mute" style="padding:0.4rem 1.5rem 0.4rem 0.75rem"><div class="flex"><span>YouQu框架生态</span></div></div></a></div></div></div></div></div></div></div><div class="flex-center flex-row"><div class="mx-2"><div class="md:mr-2 rspress-nav-appearance"><div class="p-1 border border-solid border-gray-300 text-gray-400  cursor-pointer rounded-md hover:border-gray-600 hover:text-gray-600 dark:hover:border-gray-200 dark:hover:text-gray-200 transition-all duration-300 w-7 h-7"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 24 24" class="dark:hidden" width="18" height="18" fill="currentColor"><path d="M12 18c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6m0-10c-2.2 0-4 1.8-4 4s1.8 4 4 4 4-1.8 4-4-1.8-4-4-4M12 4c-.6 0-1-.4-1-1V1c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1M12 24c-.6 0-1-.4-1-1v-2c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1M5.6 6.6c-.3 0-.5-.1-.7-.3L3.5 4.9c-.4-.4-.4-1 0-1.4s1-.4 1.4 0l1.4 1.4c.4.4.4 1 0 1.4-.1.2-.4.3-.7.3M19.8 20.8c-.3 0-.5-.1-.7-.3l-1.4-1.4c-.4-.4-.4-1 0-1.4s1-.4 1.4 0l1.4 1.4c.4.4.4 1 0 1.4-.2.2-.5.3-.7.3M3 13H1c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1M23 13h-2c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1M4.2 20.8c-.3 0-.5-.1-.7-.3-.4-.4-.4-1 0-1.4l1.4-1.4c.4-.4 1-.4 1.4 0s.4 1 0 1.4l-1.4 1.4c-.2.2-.4.3-.7.3M18.4 6.6c-.3 0-.5-.1-.7-.3-.4-.4-.4-1 0-1.4l1.4-1.4c.4-.4 1-.4 1.4 0s.4 1 0 1.4l-1.4 1.4c-.2.2-.5.3-.7.3"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 24 24" class="hidden dark:block" width="18" height="18" fill="currentColor"><path d="M12.1 22h-.9c-5.5-.5-9.5-5.4-9-10.9.4-4.8 4.2-8.6 9-9 .4 0 .8.2 1 .5s.2.8-.1 1.1c-2 2.7-1.4 6.4 1.3 8.4 2.1 1.6 5 1.6 7.1 0 .3-.2.7-.3 1.1-.1.3.2.5.6.5 1-.2 2.7-1.5 5.1-3.6 6.8-1.9 1.4-4.1 2.2-6.4 2.2M9.3 4.4c-2.9 1-5 3.6-5.2 6.8-.4 4.4 2.8 8.3 7.2 8.7 2.1.2 4.2-.4 5.8-1.8 1.1-.9 1.9-2.1 2.4-3.4-2.5.9-5.3.5-7.5-1.1-2.8-2.2-3.9-5.9-2.7-9.2"></path></svg></div></div></div><div class="social-links menu-item_e90a6 flex-center relative"><div class="flex-center h-full gap-x-4 transition-colors duration-300 md:mr-2"><a href="https://github.com/mikigo/docs" target="_blank" rel="noopener noreferrer" class="social-links"><div class="social-links-icon_a4ad0"><div><svg xmlns="http://www.w3.org/2000/svg" width="100%" viewBox="0 0 24 24"><path fill="currentColor" d="M12 .297c-6.63 0-12 5.373-12 12c0 5.303 3.438 9.8 8.205 11.385c.6.113.82-.258.82-.577c0-.285-.01-1.04-.015-2.04c-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729c1.205.084 1.838 1.236 1.838 1.236c1.07 1.835 2.809 1.305 3.495.998c.108-.776.417-1.305.76-1.605c-2.665-.3-5.466-1.332-5.466-5.93c0-1.31.465-2.38 1.235-3.22c-.135-.303-.54-1.523.105-3.176c0 0 1.005-.322 3.3 1.23c.96-.267 1.98-.399 3-.405c1.02.006 2.04.138 3 .405c2.28-1.552 3.285-1.23 3.285-1.23c.645 1.653.24 2.873.12 3.176c.765.84 1.23 1.91 1.23 3.22c0 4.61-2.805 5.625-5.475 5.92c.42.36.81 1.096.81 2.22c0 1.606-.015 2.896-.015 3.286c0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></div></div></a><div class="social-links-icon_a4ad0 cursor-pointer relative mx-3"><div><svg xmlns="http://www.w3.org/2000/svg" width="100%" viewBox="0 0 24 24"><path fill="currentColor" d="M8.691 2.188C3.891 2.188 0 5.476 0 9.53c0 2.212 1.17 4.203 3.002 5.55a.59.59 0 0 1 .213.665l-.39 1.48c-.019.07-.048.141-.048.213c0 .163.13.295.29.295a.33.33 0 0 0 .167-.054l1.903-1.114a.86.86 0 0 1 .717-.098a10.2 10.2 0 0 0 2.837.403c.276 0 .543-.027.811-.05c-.857-2.578.157-4.972 1.932-6.446c1.703-1.415 3.882-1.98 5.853-1.838c-.576-3.583-4.196-6.348-8.596-6.348M5.785 5.991c.642 0 1.162.529 1.162 1.18a1.17 1.17 0 0 1-1.162 1.178A1.17 1.17 0 0 1 4.623 7.17c0-.651.52-1.18 1.162-1.18zm5.813 0c.642 0 1.162.529 1.162 1.18a1.17 1.17 0 0 1-1.162 1.178a1.17 1.17 0 0 1-1.162-1.178c0-.651.52-1.18 1.162-1.18m5.34 2.867c-1.797-.052-3.746.512-5.28 1.786c-1.72 1.428-2.687 3.72-1.78 6.22c.942 2.453 3.666 4.229 6.884 4.229c.826 0 1.622-.12 2.361-.336a.72.72 0 0 1 .598.082l1.584.926a.3.3 0 0 0 .14.047c.134 0 .24-.111.24-.247c0-.06-.023-.12-.038-.177l-.327-1.233a.6.6 0 0 1-.023-.156a.49.49 0 0 1 .201-.398C23.024 18.48 24 16.82 24 14.98c0-3.21-2.931-5.837-6.656-6.088V8.89c-.135-.01-.27-.027-.407-.03zm-2.53 3.274c.535 0 .969.44.969.982a.976.976 0 0 1-.969.983a.976.976 0 0 1-.969-.983c0-.542.434-.982.97-.982zm4.844 0c.535 0 .969.44.969.982a.976.976 0 0 1-.969.983a.976.976 0 0 1-.969-.983c0-.542.434-.982.969-.982"/></svg></div></div></div></div></div></div><div class="mobileNavMenu_e7045"><div class="navScreen_ec30c  rspress-nav-screen" id="navScreen"><div class="container_c935d"><div class="navMenu_b887b"><div class="navMenuItem_e7978 w-full"><a class="link_a7cea  cursor-pointer" target="" href="/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">🏠首页</div></a></div><div class="navMenuItem_e7978 w-full"><a class="link_a7cea  cursor-pointer" target="" href="/autotest/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">🤖自动化技术</div></a></div><div class="navMenuItem_e7978 w-full"><a class="link_a7cea  cursor-pointer" target="" href="/program/index.html"><div class="rspress-nav-menu-item singleItem_c1154 activeItem_a28b5 text-sm font-medium mx-1.5 px-3 py-2 flex items-center">💻编程基础</div></a></div><div class="navMenuItem_e7978 w-full"><a class="link_a7cea  cursor-pointer" target="" href="/tech_doc/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">📚技术文档</div></a></div><div class="navMenuItem_e7978 w-full"><a class="link_a7cea  cursor-pointer" target="" href="/blog/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">📋博客</div></a></div><div class="navMenuItem_e7978 w-full"><a class="link_a7cea  cursor-pointer" target="" href="/cookbook/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">🧑‍🍳菜谱</div></a></div><div class="navMenuItem_e7978 w-full"><div class="mx-3 last:mr-0"><div class=" navScreenMenuGroup_e771d relative"><button class="button_ea41e"><span class="buttonSpan_f4b8f">🗃️其他</span><svg width="1em" height="1em" viewBox="0 0 32 32" class=" down_f631a "><path fill="currentColor" d="M16 22 6 12l1.4-1.4 8.6 8.6 8.6-8.6L26 12z"></path></svg></button><div><div class="items_dd149"><div><div class="py-1 font-medium"><a href="https://zeng-yi.com:5000" target="_blank" rel="noopener noreferrer" class="link_a7cea "><div><div class="flex justify-center"><span>My FileServer</span></div></div></a></div></div><div><div class="py-1 font-medium"><a href="https://youqu.uniontech.com" target="_blank" rel="noopener noreferrer" class="link_a7cea "><div><div class="flex justify-center"><span>YouQu框架生态</span></div></div></a></div></div></div></div></div></div></div></div><div class="flex-center flex-col gap-2"><div class="mt-2 navAppearance_bf893 flex justify-center"></div><div class="social-links menu-item_e90a6 flex-center relative"><div class="flex-center h-full gap-x-4 transition-colors duration-300 md:mr-2"><a href="https://github.com/mikigo/docs" target="_blank" rel="noopener noreferrer" class="social-links"><div class="social-links-icon_a4ad0"><div><svg xmlns="http://www.w3.org/2000/svg" width="100%" viewBox="0 0 24 24"><path fill="currentColor" d="M12 .297c-6.63 0-12 5.373-12 12c0 5.303 3.438 9.8 8.205 11.385c.6.113.82-.258.82-.577c0-.285-.01-1.04-.015-2.04c-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729c1.205.084 1.838 1.236 1.838 1.236c1.07 1.835 2.809 1.305 3.495.998c.108-.776.417-1.305.76-1.605c-2.665-.3-5.466-1.332-5.466-5.93c0-1.31.465-2.38 1.235-3.22c-.135-.303-.54-1.523.105-3.176c0 0 1.005-.322 3.3 1.23c.96-.267 1.98-.399 3-.405c1.02.006 2.04.138 3 .405c2.28-1.552 3.285-1.23 3.285-1.23c.645 1.653.24 2.873.12 3.176c.765.84 1.23 1.91 1.23 3.22c0 4.61-2.805 5.625-5.475 5.92c.42.36.81 1.096.81 2.22c0 1.606-.015 2.896-.015 3.286c0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></div></div></a><div class="social-links-icon_a4ad0 cursor-pointer relative mx-3"><div><svg xmlns="http://www.w3.org/2000/svg" width="100%" viewBox="0 0 24 24"><path fill="currentColor" d="M8.691 2.188C3.891 2.188 0 5.476 0 9.53c0 2.212 1.17 4.203 3.002 5.55a.59.59 0 0 1 .213.665l-.39 1.48c-.019.07-.048.141-.048.213c0 .163.13.295.29.295a.33.33 0 0 0 .167-.054l1.903-1.114a.86.86 0 0 1 .717-.098a10.2 10.2 0 0 0 2.837.403c.276 0 .543-.027.811-.05c-.857-2.578.157-4.972 1.932-6.446c1.703-1.415 3.882-1.98 5.853-1.838c-.576-3.583-4.196-6.348-8.596-6.348M5.785 5.991c.642 0 1.162.529 1.162 1.18a1.17 1.17 0 0 1-1.162 1.178A1.17 1.17 0 0 1 4.623 7.17c0-.651.52-1.18 1.162-1.18zm5.813 0c.642 0 1.162.529 1.162 1.18a1.17 1.17 0 0 1-1.162 1.178a1.17 1.17 0 0 1-1.162-1.178c0-.651.52-1.18 1.162-1.18m5.34 2.867c-1.797-.052-3.746.512-5.28 1.786c-1.72 1.428-2.687 3.72-1.78 6.22c.942 2.453 3.666 4.229 6.884 4.229c.826 0 1.622-.12 2.361-.336a.72.72 0 0 1 .598.082l1.584.926a.3.3 0 0 0 .14.047c.134 0 .24-.111.24-.247c0-.06-.023-.12-.038-.177l-.327-1.233a.6.6 0 0 1-.023-.156a.49.49 0 0 1 .201-.398C23.024 18.48 24 16.82 24 14.98c0-3.21-2.931-5.837-6.656-6.088V8.89c-.135-.01-.27-.027-.407-.03zm-2.53 3.274c.535 0 .969.44.969.982a.976.976 0 0 1-.969.983a.976.976 0 0 1-.969-.983c0-.542.434-.982.97-.982zm4.844 0c.535 0 .969.44.969.982a.976.976 0 0 1-.969.983a.976.976 0 0 1-.969-.983c0-.542.434-.982.969-.982"/></svg></div></div></div></div></div></div></div><button aria-label="mobile hamburger" class=" rspress-mobile-hamburger navHamburger_ac64c text-gray-500"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="currentColor"><circle cx="8" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="24" cy="16" r="2" fill="currentColor"></circle></svg></button></div></div></div></div><section><div class="docLayout_af141 pt-0"><aside class="sidebar_dd719 rspress-sidebar "><div class="navTitleMask_fb17c"><div class="navBarTitle_c5f07"><a class="link_a7cea flex items-center w-full h-full text-base font-semibold transition-opacity duration-300 hover:opacity-60 cursor-pointer" target="" href="/index.html"><div class="mr-1 min-w-8"><img src="/logo.png" alt="logo" id="logo" class="rspress-logo"/></div><span>mikigo</span></a></div></div><div class="rspress-scrollbar sidebarContent_da296"><nav class="pb-2"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/index.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:14px;margin-left:0;border-radius:0 var(--rp-radius) var(--rp-radius) 0;padding-left:24px;font-weight:bold"><span>章节预览</span></div></a><section class="rspress-sidebar-section mt-0.5 block" style="margin-left:0"><div class="rspress-sidebar-collapse flex justify-between items-center menuItem_ac22e" style="border-radius:0 var(--rp-radius) var(--rp-radius) 0;cursor:pointer"><h2 class="py-2 px-3 text-sm font-medium flex" style="font-size:14px;padding-left:24px;font-weight:bold"><span class="flex-center" style="font-size:14px">Python</span></h2><div class="collapseContainer_d6e4e p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Python/Linux上如何选择用pip3还是sudopip3.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Linux 上如何选择用 pip3 还是 sudo pip3</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Python/Linux上安装Python3.9.9.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Linux 上安装 Python 3.9.9</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Python/MMDetection入门基础.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>MMDetection 入门基础</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Python/OpenCV(Python)基础—9小时入门版.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>OpenCV(Python)基础—9小时入门版</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Python/Python从进阶到高级—通俗易懂版.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Python从进阶到高级—通俗易懂版</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Python/Python包构建和发布.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Python包构建和发布</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Python/Python基础语法—8小时入门版.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Python基础语法—8小时入门版</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Python/Python最强静态代码检查&amp;格式化工具Ruff.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Python最强代码检查&amp;格式化工具Ruff</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Python/Python环境与依赖管理.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Python环境与依赖管理</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Python/Python风格指南.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Python风格指南</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Python/常用的获取随机字符串的方法.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>常用的获取随机字符串的方法</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Python/配置Python源的几种方法.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>配置 Python 源的几种方法</span></div></a></div></div></div></section><section class="rspress-sidebar-section mt-0.5 block" style="margin-left:0"><div class="rspress-sidebar-collapse flex justify-between items-center menuItem_ac22e" style="border-radius:0 var(--rp-radius) var(--rp-radius) 0;cursor:pointer"><h2 class="py-2 px-3 text-sm font-medium flex" style="font-size:14px;padding-left:24px;font-weight:bold"><span class="flex-center" style="font-size:14px">Linux</span></h2><div class="collapseContainer_d6e4e p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Linux/Docker入门.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Docker入门</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Linux/FFmpeg常用命令与参数解释.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>FFmpeg常用命令与参数解释</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Linux/FTP服务搭建.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>FTP服务搭建</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Linux/KVM安装配置及使用说明.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>KVM安装配置及使用说明</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Linux/Linux上sudo免密.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Linux 上 sudo 免密</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Linux/Linux上远程桌面VNC配置.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Linux 上远程桌面 VNC 服务配置</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Linux/Linux基础.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Linux&amp;Shell基础</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Linux/NVIDIA驱动&amp;CUDA&amp;cuDNN安装.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>NVIDIA驱动&amp;CUDA&amp;cuDNN安装</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Linux/Nginx入门使用.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Nginx入门使用</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Linux/U盘新建分区和文件系统.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>U盘新建分区和文件系统</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Linux/dde-dconfig使用.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>dde-config使用</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Linux/deb安装包制作.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>deb安装包制作</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Linux/vim配置和插件选择.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>vim配置和插件使用</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Linux/配置开机自启服务.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>配置开机自启服务</span></div></a></div></div></div></section><section class="rspress-sidebar-section mt-0.5 block" style="margin-left:0"><div class="rspress-sidebar-collapse flex justify-between items-center menuItem_ac22e" style="border-radius:0 var(--rp-radius) var(--rp-radius) 0;cursor:pointer"><h2 class="py-2 px-3 text-sm font-medium flex" style="font-size:14px;padding-left:24px;font-weight:bold"><span class="flex-center" style="font-size:14px">Shell</span></h2><div class="collapseContainer_d6e4e p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Shell/Shell参数传递.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Shell参数传递</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Shell/Shell变量使用.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Shell变量使用</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Shell/Shell字符串处理.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Shell字符串处理</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Shell/Shell数学运算.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>返回最后一个表达式的执行结果</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Shell/Shell编码规范错误参考手册.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Shell编码规范错误参考手册</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Shell/Shell进程控制.html"><div class="menuItemActive_de63c mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Shell进程调用</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Shell/Shell风格指南.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Shell风格指南</span></div></a></div></div></div></section><section class="rspress-sidebar-section mt-0.5 block" style="margin-left:0"><div class="rspress-sidebar-collapse flex justify-between items-center menuItem_ac22e" style="border-radius:0 var(--rp-radius) var(--rp-radius) 0;cursor:pointer"><h2 class="py-2 px-3 text-sm font-medium flex" style="font-size:14px;padding-left:24px;font-weight:bold"><span class="flex-center" style="font-size:14px">前后端</span></h2><div class="collapseContainer_d6e4e p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/前后端/CSS基础.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>CSS 基础</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/前后端/Django基础知识.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Django基础知识</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/前后端/Django进阶技巧.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Django进阶技巧</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/前后端/FastAPI—8小时入门版.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>FastAPI—8小时入门版</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/前后端/JS基础.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>JS基础教程</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/前后端/Linux上安装Nodejs.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Linux 上安装 Nodejs</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/前后端/MySQL基础.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>MySQL基础</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/前后端/Vue基础.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Vue基础</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/前后端/Web基础.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>web基础</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/前后端/html基础.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>HTML 基础</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/前后端/测开前端学习基础分享.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>测开前端学习基础分享</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/前后端/研测平台权限管理前端设计.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>平台权限管理前端设计</span></div></a></div></div></div></section><section class="rspress-sidebar-section mt-0.5 block" style="margin-left:0"><div class="rspress-sidebar-collapse flex justify-between items-center menuItem_ac22e" style="border-radius:0 var(--rp-radius) var(--rp-radius) 0;cursor:pointer"><h2 class="py-2 px-3 text-sm font-medium flex" style="font-size:14px;padding-left:24px;font-weight:bold"><span class="flex-center" style="font-size:14px">Jenkins</span></h2><div class="collapseContainer_d6e4e p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Jenkins/Jenkins环境搭建以及任务创建.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Jenkins环境搭建以及任务创建</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/Jenkins/Pipeline语法介绍.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Pipeline语法介绍</span></div></a></div></div></div></section><section class="rspress-sidebar-section mt-0.5 block" style="margin-left:0"><div class="rspress-sidebar-collapse flex justify-between items-center menuItem_ac22e" style="border-radius:0 var(--rp-radius) var(--rp-radius) 0;cursor:pointer"><h2 class="py-2 px-3 text-sm font-medium flex" style="font-size:14px;padding-left:24px;font-weight:bold"><span class="flex-center" style="font-size:14px">网络爬虫</span></h2><div class="collapseContainer_d6e4e p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/网络爬虫/Httpx.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Httpx</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/网络爬虫/Requests.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Requests</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/program/网络爬虫/Scrapy.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>Scrapy</span></div></a></div></div></div></section></nav></div></aside><div class="flex-1 relative min-w-0"><div class="rspress-sidebar-menu-container "><div class="rspress-sidebar-menu"><button type="button" class="flex-center mr-auto"><div class="text-md mr-2"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M4 6h24v2H4zm0 18h24v2H4zm0-12h24v2H4zm0 6h24v2H4z"></path></svg></div><span class="text-sm">Menu</span></button><button type="button" class="flex-center ml-auto"><span class="text-sm">本页目录</span><div class="text-md mr-2" style="transform:rotate(0deg);transition:transform 0.2s ease-out;margin-top:2px"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></button><div class="rspress-local-toc-container "><ul><li><a href="#1-进程调用无处不在" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">1. 进程调用无处不在</span></a></li><li><a href="#2-脚本的调用" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">2. 脚本的调用</span></a></li><li><a href="#3-进程的后台处理" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">3. 进程的后台处理</span></a></li><li><a href="#31-进程后台运行" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">3.1 进程后台运行</span></a></li><li><a href="#32-查询后台进程" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">3.2 查询后台进程</span></a></li><li><a href="#33-恢复后台进程" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">3.3 恢复后台进程</span></a></li><li><a href="#4-守护进程" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">4. 守护进程</span></a></li><li><a href="#5-进程的并发控制" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">5. 进程的并发控制</span></a></li><li><a href="#51-一个简单的并发例子" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">5.1 一个简单的并发例子</span></a></li><li><a href="#52-shell进程的同步机制" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">5.2 Shell进程的同步机制</span></a></li><li><a href="#53-多进程并发" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">5.3 多进程并发</span></a></li><li><a href="#6-进程间通信" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">6. 进程间通信</span></a></li><li><a href="#61-匿名管道" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">6.1 匿名管道</span></a></li><li><a href="#62-命名管道" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">6.2 命名管道</span></a></li><li><a href="#63-普通文件传递消息" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">6.3 普通文件传递消息</span></a></li><li><a href="#7-进程的远程调用" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">7. 进程的远程调用</span></a></li><li><a href="#71-进程执行简单命令" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">7.1 进程执行简单命令</span></a></li><li><a href="#72-进程执行多条命令组合" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">7.2 进程执行多条命令组合</span></a></li><li><a href="#73-本地脚本远程执行" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">7.3 本地脚本远程执行</span></a></li><li><a href="#8-信号处理" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">8. 信号处理</span></a></li><li><a href="#81-linux信号" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">8.1 Linux信号</span></a></li><li><a href="#82-信号的发送和接收" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">8.2 信号的发送和接收</span></a></li><li><a href="#821-trap-捕捉信号" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:24px"><span class="rspress-toc-link-text block">8.2.1 <code>trap</code> 捕捉信号。</span></a></li><li><a href="#822-kill-发送信号" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:24px"><span class="rspress-toc-link-text block">8.2.2 <code>kill</code> 发送信号。</span></a></li><li><a href="#83-进程通过信号通信" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">8.3 进程通过信号通信</span></a></li></ul></div></div></div><div class="content_ff766 rspress-doc-container flex"><div class="flex-1 overflow-x-auto"><div class="rspress-doc"><!--$--><h1 id="shell进程调用" class="rspress-doc-title text-3xl mb-10 leading-10 tracking-tight title_fb7eb">Shell进程调用<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#shell进程调用">#</a></h1>
<h2 id="1-进程调用无处不在" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">1. 进程调用无处不在<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#1-进程调用无处不在">#</a></h2>
<p class="my-4 leading-7">实际上，Shell脚本的进程调用无处不在，除了shell自身的内建命令，Shell调用工具命令都会开辟一个子进程去执行，比如在shell脚本中使用sed，grep，sleep等命令。</p>
<p class="my-4 leading-7"><code>test@test-PC:~$ vim proc.sh</code></p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token shebang" style="color:#EBCB8B;font-weight:bold">#!/bin/bash</span><span>
</span></span><span style="display:block;padding:0 1.25rem">  
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;fork a sleep process.&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">20</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">exit</span><span> </span><span class="token number">0</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">如上例，在Bash脚本中执行一个sleep， 执行脚本，新开终端查询进程。查询结果分析可以看到，sleep 20做为一个子进程在运行，进程ID为<code>14586</code>,而他的父进程正是proc.sh脚本进程，ID为<code>14586</code>。</p>
<p class="my-4 leading-7"><code>test@test-PC:~$ bash proc.sh</code><br/>
<code>test@test-PC:~$ ps -ef | grep -E &#x27;sleep|proc.sh&#x27;</code></p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>fenglg   14586  9358  0 09:33 pts/0    00:00:00 bash proc.sh
fenglg   14587 14586  0 09:33 pts/0    00:00:00 sleep 20
fenglg   14634 25734  0 09:34 pts/1    00:00:00 grep -E sleep|proc.sh
</code></div></div>
<h2 id="2-脚本的调用" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">2. 脚本的调用<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#2-脚本的调用">#</a></h2>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7">调用方法1：
<code>bash script.sh</code><br/>
<!-- -->在当前Shell中开辟一个子进程shell运行script.sh脚本， 与父进程共享环境变量；script.sh文件可不必有可执行权限，已经显示的给出调用script.sh的解析器为Bash。</p>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7">调用方法2：<code>./script.sh</code><br/>
<!-- -->在当前Shell中开辟一个子进程shell运行script.sh脚本， 与父进程共享环境变量；script.sh文件必须有可执行权限，否则权限错误，使用哪种shell解释执行，取决于脚本开头的声明，如<code>#!/bin/bash</code>，如未进行声明，默认使用当前终端所用Shell。</p>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7">调用方法3： <code>. script.sh</code><br/>
<!-- -->在当前Shell进程中执行script.sh，与当前shell同一进程，共享全局变量和环境变量。script.sh如有exit，则退出当前shell。</p>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7">调用方法4： <code>source script.sh</code><br/>
<!-- -->同调用方法3</p>
<p class="my-4 leading-7"><strong class="font-semibold">补充说明</strong></p>
<blockquote class="border-l-2 border-solid border-divider pl-4 my-6 transition-colors duration-500 blockquote_f1063">
<ol class="list-decimal pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">调用方法1,2 都是新开shell进程执行， 调用方法3,4都是当前进程中执行；</li>
<li class="[&amp;:not(:first-child)]:mt-2">调用方法3,4的常用场景在需要导入环境变量，全局变量，或者导入公共函数处理脚本时使用，使用<code>.</code>和使用<code>source</code>效果是一样的，但source是Bash的内建命令，并非所有Shell解析器都能支持，所以从脚本的健壮性和通用性角度讲，推荐使用<code>.</code>。</li>
</ol>
</blockquote>
</li>
</ul>
<h2 id="3-进程的后台处理" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">3. 进程的后台处理<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#3-进程的后台处理">#</a></h2>
<h3 id="31-进程后台运行" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">3.1 进程后台运行<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#31-进程后台运行">#</a></h3>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><code>&amp;</code>： 使用<code>&amp;</code>符号，在调用进程或者函数后加 <code>&amp;</code>，即将进程放到后台去执行。如下，<code>sleep</code>进程被放入后台，进程ID为<code>13358</code>。<!-- -->
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/code/cli$ sleep 30 &amp;
[1] 13358
</code></div></div>
</li>
<li class="[&amp;:not(:first-child)]:mt-2"><code>Ctrl</code>+<code>z</code>： 如果是在终端中调用的命令或脚本，可以通过键入<code>Ctrl</code>+<code>z</code>，将命令或脚本放入后并挂起进程，<!-- -->注意：进程在后台不再运行，是停止状态，等待唤醒指令后才能继续运行<!-- -->。<!-- -->
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/code/cli$ sleep 20 
^Z
[1]+  已停止               sleep 20
</code></div></div>
</li>
</ul>
<h3 id="32-查询后台进程" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">3.2 查询后台进程<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#32-查询后台进程">#</a></h3>
<p class="my-4 leading-7"><code>jobs</code>:使用<code>jobs</code>命令后台运行中的进程。<code>[1]</code> 中括号里的数字表示进程的作业号，唤醒和恢复时可以指定进程。<code>+</code>代表当前进程，<code>-</code>代表当前进程的上一进程，使用<code>fg</code>恢复时如不指定作业号，默认恢复当前进程。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/code/cli$ jobs
[1]+  已停止               sleep 20
[2]-  运行中               sleep 30 &amp;
</code></div></div>
<p class="my-4 leading-7"><code>jobs</code>支持参数选项来对后台进程进行筛选。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>jobs [-lnprs]
     -l     普通信息之外，列出进程ID。
     -p     只列出作业的进程组 leader 的进程ID。
     -n     只显示从上次用户得知它们的状态之后，状态发生改变的作业的信息。
     -r     限制只输出正在运行的作业。
     -s     限制只输出停止的作业。
</code></div></div>
<h3 id="33-恢复后台进程" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">3.3 恢复后台进程<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#33-恢复后台进程">#</a></h3>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>fg</code>:将后台进程恢复到前台运行, 通过<code>fg number</code>指定进程作业号来恢复指定进程。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/code/cli$ fg 2
sleep 30
</code></div></div>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>bg</code>:将后台进程唤醒，继续在后台执行,即将挂起的任务进程的状态由 stopped 改为 running。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/code/cli$ bg 1
[1]+ sleep 20 &amp;
test@test-PC:~/work/code/cli$ jobs
[1]+  运行中               sleep 20 &amp;
test@test-PC:~/work/code/cli$ 
</code></div></div>
</li>
</ul>
<h2 id="4-守护进程" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">4. 守护进程<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#4-守护进程">#</a></h2>
<p class="my-4 leading-7">通常我们运行脚本或者命令是在一个用户终端下，不论脚本是在前后还是后台运行，当我们关闭终端，脚本和命令进程也会随之消亡。这是因为终端退出时会对终端下的子shell进程发送<code>SIGHUP</code>信号，子进程shell进程收到信号默认终止进程运行。</p>
<p class="my-4 leading-7">有时这并不是我们想要的，比如写一个长时间运行的批处理脚本，如产品安装，升级，构建，脚本执行时长可能以小时来计算，在这期间如果终端异常中断，脚本也会中断，任务就会执行失败。</p>
<p class="my-4 leading-7">这里我们引入守护进程，借鉴了传统编程语言守护进程的概念（如C++/Java），Shell的守护进程可以狭义的理解为脱离了用户终端而在后台运行的进程。
实现方法如下：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>nohup script.sh &amp;</code> ： <code>nohup</code>通知脚本<code>script.sh</code>忽略掉终端断连信号<code>SIGHUP</code>，即终端断开时进程不会退出。如下，<code>sleep</code>进程放入后台，ID为<code>27310</code>。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/study/shell/share$ nohup sleep 800 &amp;
[1] 27310
test@test-PC:~/work/study/shell/share$ nohup: 忽略输入并把输出追加到&#x27;nohup.out&#x27;

test@test-PC:~/work/study/shell/share$ jobs -l
[1]+ 27310 运行中               nohup sleep 800 &amp;
test@test-PC:~/work/study/shell/share$ 
test@test-PC:~/work/study/shell/share$ ps -ef | grep sleep 
fenglg   27310  9491  0 11:40 pts/1    00:00:00 sleep 800
</code></div></div>
<p class="my-4 leading-7">终端退出，再次登录查看<code>sleep</code>进程,进程ID<code>27310</code>仍然在运行，它已被 <code>init</code>进程(ID为<code>1</code>)接收。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~$ ps -ef | grep sleep
fenglg   27310     1  0 11:40 ?        00:00:00 sleep 800
fenglg   28176 28150  0 11:43 pts/1    00:00:00 grep sleep
</code></div></div>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7">在脚本中忽略终端退出信号
改变进程接收<code>SIGHUP</code>信号后的默认处理方式，即主动捕捉信号并自定义处理方式。
在脚本中，需要开始忽略<code>SIGHUP</code>的核心代码运行之前，加入<code>trap &quot;&quot; HUP</code>， <code>&quot;&quot;</code>中可以自定义一个函数名，在接收到<code>SIGHUP</code>信号后执行该函数，也可以为空，不做任务处理，即忽略掉<code>SIGHUP</code>信号，程序照常运行。
<code>test@test-PC:~/work/study/shell/share$ vi sighup.sh</code></p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token shebang" style="color:#EBCB8B;font-weight:bold">#!/bin/bash</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token function-name" style="color:var(--code-token-function)">main</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>   </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">2000</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">trap</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;&quot;</span><span> HUP
</span></span><span style="display:block;padding:0 1.25rem">main</span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/study/shell/share$ bash sighup.sh  &amp;
[1] 1057
test@test-PC:~/work/study/shell/share$ ps -ef | grep sleep 
fenglg    1058  1057  0 11:59 pts/4    00:00:00 sleep 2000
</code></div></div>
<p class="my-4 leading-7">重启终端，查看进程并未退出。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~$ ps -ef | grep sleep
fenglg    1058     1057  0 11:59 ?        00:00:00 sleep 2000
</code></div></div>
</li>
</ul>
<h2 id="5-进程的并发控制" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">5. 进程的并发控制<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#5-进程的并发控制">#</a></h2>
<h3 id="51-一个简单的并发例子" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">5.1 一个简单的并发例子<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#51-一个简单的并发例子">#</a></h3>
<p class="my-4 leading-7">shell也可以通过进程并发的方式提高运行效果，以下是最简单的shell进程并发例子。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token shebang" style="color:#EBCB8B;font-weight:bold">#!/bin/bash</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">function</span><span> </span><span class="token function-name" style="color:var(--code-token-function)">child_process</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>   </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">5</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>   </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;I am a child process!&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">function</span><span> </span><span class="token function-name" style="color:var(--code-token-function)">main_process</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>   child_process </span><span class="token operator">&amp;</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span>   </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;I am a main process!&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">main_process</span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">以上是两个进程，主进程和子进程同时运行，各自打印自己的信息。 <code>child_process</code>子进程被放到了后台运行，主进程并没有等子进程运行完成就退出了。子进程在后台继续运行，直到退出。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/study/shell/share$ bash process.sh
I am a main process!
test@test-PC:~/work/study/shell/share$ I am a child process!
</code></div></div>
<h3 id="52-shell进程的同步机制" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">5.2 Shell进程的同步机制<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#52-shell进程的同步机制">#</a></h3>
<p class="my-4 leading-7">优化一下上述脚本，引入进程同步机制，主进程等待子进程执行完毕后再退出。这里引入<code>wait</code>命令。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token shebang" style="color:#EBCB8B;font-weight:bold">#!/bin/bash</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">function</span><span> </span><span class="token function-name" style="color:var(--code-token-function)">child_process</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>  
</span></span><span style="display:block;padding:0 1.25rem"><span>   </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">5</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>   </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;[</span><span class="token" style="color:var(--code-token-variable)">$$</span><span class="token" style="color:var(--code-token-string)">]I am a child process,I quit!&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">function</span><span> </span><span class="token function-name" style="color:var(--code-token-function)">main_process</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>   child_process </span><span class="token operator">&amp;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>   </span><span class="token" style="color:var(--code-token-function)">wait</span><span> </span><span class="token" style="color:var(--code-token-variable)">$!</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span>   </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;[</span><span class="token" style="color:var(--code-token-variable)">$$</span><span class="token" style="color:var(--code-token-string)">]I am a main process!I quit!&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">main_process</span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><code>$$</code>:当前shell的进程ID
<code>$!</code>：最后一个运行在后台的进程ID
在父进程里使用<code>wait</code>以阻塞的方式等待子进程执行完毕，父进程（主进程）得以继续执行。这里值得注意的是不管父进程，还是子进程，打印PID都是<code>1161</code>，即当前shell进程的PID,这是bash的自身机制。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/study/shell/share$ bash process.sh 
[1161]I am a child process,I quit!
[1161]I am a main process!I quit!
</code></div></div>
<h3 id="53-多进程并发" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">5.3 多进程并发<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#53-多进程并发">#</a></h3>
<p class="my-4 leading-7">并发的目的是为了提高运行效率，以另外一种机制来实现多进程并发与同步。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token shebang" style="color:#EBCB8B;font-weight:bold">#!/bin/bash</span><span>
</span></span><span style="display:block;padding:0 1.25rem">  
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">declare</span><span> -a pidlist           </span><span class="token" style="color:var(--code-token-comment)">#声明一个数组，用来收集子进程ID</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">for</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">((</span><span class="token" style="color:var(--code-token-variable)">i</span><span class="token operator" style="color:var(--code-token-variable)">=</span><span class="token number" style="color:var(--code-token-variable)">0</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span class="token" style="color:var(--code-token-variable)"> i </span><span class="token operator" style="color:var(--code-token-variable)">&lt;</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token number" style="color:var(--code-token-variable)">5</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span class="token" style="color:var(--code-token-variable)"> i</span><span class="token operator" style="color:var(--code-token-variable)">++</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token" style="color:var(--code-token-punctuation)">))</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">do</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token" style="color:var(--code-token-variable)">$((</span><span class="token" style="color:var(--code-token-variable)">i</span><span class="token operator" style="color:var(--code-token-variable)">+</span><span class="token number" style="color:var(--code-token-variable)">1</span><span class="token" style="color:var(--code-token-variable)">))</span><span> </span><span class="token operator">&amp;</span><span>         </span><span class="token" style="color:var(--code-token-comment)">#将子进程交付后台执行</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    pidlist</span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token" style="color:var(--code-token-variable)">$i</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span class="token operator">=</span><span class="token" style="color:var(--code-token-variable)">$!</span><span>           </span><span class="token" style="color:var(--code-token-comment)">#将子进程ID(这里用$!表示最后一个后台进程ID)收集进数组</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;=Child process[</span><span class="token" style="color:var(--code-token-variable)">$!</span><span class="token" style="color:var(--code-token-string)">] is running ...&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">done</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">while</span><span> </span><span class="token class-name" style="color:var(--code-token-symbol)">:</span><span>                      </span><span class="token" style="color:var(--code-token-comment)"># 主进程无限循环监控子进程</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">do</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>   </span><span class="token assign-left" style="color:var(--code-token-variable)">pcount</span><span class="token operator">=</span><span class="token" style="color:var(--code-token-variable)">${</span><span class="token operator" style="color:var(--code-token-variable)">#</span><span class="token" style="color:var(--code-token-variable)">pidlist</span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token" style="color:var(--code-token-variable)">@</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span class="token" style="color:var(--code-token-variable)">}</span><span> </span><span class="token operator">&amp;&amp;</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">[</span><span> </span><span class="token" style="color:var(--code-token-variable)">${pcount}</span><span> -le </span><span class="token number">0</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">]</span><span> </span><span class="token operator">&amp;&amp;</span><span> </span><span class="token class-name" style="color:var(--code-token-symbol)">break</span><span>  </span><span class="token" style="color:var(--code-token-comment)">#如果数组为空，表示全部子进程已经退出。</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>   </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;+[</span><span class="token" style="color:var(--code-token-variable)">$pcount</span><span class="token" style="color:var(--code-token-string)">]:[</span><span class="token" style="color:var(--code-token-variable)">${pidlist</span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token" style="color:var(--code-token-variable)">@</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span class="token" style="color:var(--code-token-variable)">}</span><span class="token" style="color:var(--code-token-string)">] is running...&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>   </span><span class="token" style="color:var(--code-token-keyword)">for</span><span> </span><span class="token for-or-select" style="color:var(--code-token-variable)">pid</span><span> </span><span class="token" style="color:var(--code-token-keyword)">in</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;</span><span class="token" style="color:var(--code-token-variable)">${pidlist</span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token" style="color:var(--code-token-variable)">@</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span class="token" style="color:var(--code-token-variable)">}</span><span class="token" style="color:var(--code-token-string)">&quot;</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span> </span><span class="token" style="color:var(--code-token-keyword)">do</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>       </span><span class="token" style="color:var(--code-token-function)">kill</span><span> -0 </span><span class="token" style="color:var(--code-token-variable)">${pid}</span><span> </span><span class="token operator">&amp;&gt;</span><span>/dev/null   </span><span class="token" style="color:var(--code-token-comment)"># 使用kill -0 监控子进程是否存在，如果不存在，则返回非0</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>       </span><span class="token" style="color:var(--code-token-keyword)">if</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">[</span><span> </span><span class="token" style="color:var(--code-token-variable)">$?</span><span> -ne </span><span class="token number">0</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">]</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span> </span><span class="token" style="color:var(--code-token-keyword)">then</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>           </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;-[</span><span class="token" style="color:var(--code-token-variable)">${pid}</span><span class="token" style="color:var(--code-token-string)">]child quit!&quot;</span><span> 
</span></span><span style="display:block;padding:0 1.25rem"><span>           </span><span class="token assign-left" style="color:var(--code-token-variable)">pidlist</span><span class="token operator">=</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span> </span><span class="token" style="color:var(--code-token-variable)">${pidlist</span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token" style="color:var(--code-token-variable)">@</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span class="token operator" style="color:var(--code-token-variable)">/</span><span class="token" style="color:var(--code-token-variable)">${pid}</span><span>/</span><span class="token" style="color:var(--code-token-punctuation)">}</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>    </span><span class="token" style="color:var(--code-token-comment)">#将已经退出的子进程ID清理出数组</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>       </span><span class="token" style="color:var(--code-token-keyword)">fi</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>   </span><span class="token" style="color:var(--code-token-keyword)">done</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>   </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">1</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">done</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;-[</span><span class="token" style="color:var(--code-token-variable)">$$</span><span class="token" style="color:var(--code-token-string)">]main process quit!&quot;</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7">1）上面是用数组的方式采集进程ID，实现了5个子进程并发处理，子进程命令为<code>sleep</code>，这里根据业务需要可以替换成自定义的批处理进程，脚本，函数等；</p>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7">2）这里进程间的同步是通过kill -0查询进程是否存在，查询的时长取决于执行时间最长的子进程。通过并发后脚本执行时长为5秒，如果串行则时长为15秒。</p>
</li>
</ul>
<h2 id="6-进程间通信" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">6. 进程间通信<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#6-进程间通信">#</a></h2>
<p class="my-4 leading-7">进程间通信（IPC，InterProcess Communication）是指在不同进程之间传播或交换信息。</p>
<p class="my-4 leading-7">编程语言常用的IPC的方式有管道（包括匿名管道和命名管道）、消息队列、信号量、共享内存等，如果涉及跨主机通信，可以使用Socket等。</p>
<p class="my-4 leading-7">当然Shell做为解释性语言无法直接实现上面的底层开发，这也不是我们使用Shell的初衷，但是我们仍然可以借助工具，借鉴思路实现简单的进程通信，以满足业务需要。</p>
<h3 id="61-匿名管道" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">6.1 匿名管道<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#61-匿名管道">#</a></h3>
<p class="my-4 leading-7">匿名管道使用符号 <code>|</code> 表示,这是我们最常用的进程间通信方式了，管道左侧接收进程的标准输出，右侧是进程的标准输入。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>echo &quot;Name:Jack,Age:22,Gender:Man,Desc:null&quot; | cut -d&quot;,&quot; -f1 | sed &#x27;s/Name://g&#x27;
</code></div></div>
<p class="my-4 leading-7">如上例，一行代码我们使用了两个<code>|</code>，为了方便叙述我们称为管道1和管道2。 管道1左侧<code>echo</code>进程输出信息，原本是要送到标准输出（<code>STDOUT</code>）的,这里被管道1接收； 管道1右侧<code>cut</code>进程从管道1中读入信息，做出处理，然后输出到管道2；而<code>sed</code>进程又从从管道2中读入信息，做处理，将结果输出到标准输出。</p>
<p class="my-4 leading-7">注意：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><code>|</code>两侧是标准输出和标准输入，所以如果左侧是标准错误，是不会被送入管道，右侧也就无法接收处理。如下,<code>ls</code>的执行结果还是被送到了标准错误，在屏幕中显示，并没有进入管道。<!-- -->
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/study/shell/share$ ls &quot;not exist!&quot; | cut -d&quot;,&quot; -f1 | sed &#x27;s/Name://g&#x27; 
ls: 无法访问&#x27;not exist!&#x27;: 没有那个文件或目录
</code></div></div>
</li>
</ul>
<h3 id="62-命名管道" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">6.2 命名管道<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#62-命名管道">#</a></h3>
<p class="my-4 leading-7"><code>mkfifo</code>:用来创建命名管道，命名管道是一种特殊的文件，同一操作系统内的进程都可以向命名管道内写入消息，同理，也可以读取消息，消息写入和读取是双向的，跟普通文件一样，读写前提是进程要有权限。
如下是创建一个命名管道，权限标志位置第一个字母是<code>p</code>，代表这是管道文件（-：普通文件，d:目录文件，l:链接文件，b:设备文件，c:字符设备文件，p:管道文件），其它权限标志跟普通文件是一致的。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/study/shell/share$ mkfifo fifo
test@test-PC:~/work/study/shell/share$ ls -l
prw-r--r-- 1 fenglg fenglg    0 11月 20 10:21 fifo
</code></div></div>
<p class="my-4 leading-7">向管道写入信息,写入后会阻塞等待进程读取。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/study/shell/share$ echo &quot;Name:Jack,Age:22,Gender:Man,Desc:null&quot; &gt; fifo 

</code></div></div>
<p class="my-4 leading-7">向管道读取信息，我们用<code>cat</code>命令，跟读取文件一样，如果管道内无消息，则阻塞等待消息进入管道。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/study/shell/share$ cat fifo
Name:Jack,Age:22,Gender:Man,Desc:null
test@test-PC:~/work/study/shell/share$ 
</code></div></div>
<p class="my-4 leading-7">读取信息完毕之后，<code>cat</code>进程退出，当然你也可以做后续的处理； 而写入进程<code>echo</code>在管道内信息被取走之后，进程也随之退出。</p>
<p class="my-4 leading-7">可以看到，命名管道是通过阻塞的方式进行进程同步的，可以多个进程写入消息，读取进程按照 <strong class="font-semibold">先进先出</strong> 的顺序取走消息。可不可以多个进程读呢，当然也是可以的，但是消息被取走之后管道就空了（除非有新消息写入），多个进程来读，总是最先读取的进程拿到消息，后来读取的因为管道空了，只有阻塞等待，直到有新消息写入。</p>
<p class="my-4 leading-7">我们可以借助传统编程语言的思路做一个服务端和客户端程序：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">server端：</li>
</ul>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token assign-left" style="color:var(--code-token-variable)">PIPEFILE</span><span class="token operator">=</span><span>./fifo
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-function)">mkfifo</span><span> -m </span><span class="token number">600</span><span> </span><span class="token" style="color:var(--code-token-variable)">${PIPEFILE}</span><span>     </span><span class="token" style="color:var(--code-token-comment)">#创建一个命名管道，并设置文件权限</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token function-name" style="color:var(--code-token-function)">process_line</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;[</span><span class="token" style="color:var(--code-token-variable)">$1</span><span class="token" style="color:var(--code-token-string)">] process here ..&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;Server Started ...&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">while</span><span> </span><span class="token class-name" style="color:var(--code-token-symbol)">:</span><span>                      </span><span class="token" style="color:var(--code-token-comment)">#外循环不断监控管道是否有数据写入</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">do</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">while</span><span> </span><span class="token class-name" style="color:var(--code-token-symbol)">read</span><span> line          </span><span class="token" style="color:var(--code-token-comment)">#按行读取数据</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">do</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>       </span><span class="token assign-left" style="color:var(--code-token-variable)">name</span><span class="token operator">=</span><span class="token" style="color:var(--code-token-variable)">$(</span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token" style="color:var(--code-token-string)">&quot;</span><span class="token" style="color:var(--code-token-string)">${line}</span><span class="token" style="color:var(--code-token-string)">&quot;</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token operator" style="color:var(--code-token-variable)">|</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token" style="color:var(--code-token-function)">cut</span><span class="token" style="color:var(--code-token-variable)"> -d</span><span class="token" style="color:var(--code-token-string)">&quot;,&quot;</span><span class="token" style="color:var(--code-token-variable)"> -f1 </span><span class="token operator" style="color:var(--code-token-variable)">|</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token" style="color:var(--code-token-function)">sed</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token" style="color:var(--code-token-string)">&#x27;s/Name://g&#x27;</span><span class="token" style="color:var(--code-token-variable)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>       process_line </span><span class="token" style="color:var(--code-token-string)">&quot;</span><span class="token" style="color:var(--code-token-variable)">${name}</span><span class="token" style="color:var(--code-token-string)">&quot;</span><span>  </span><span class="token operator">&amp;</span><span>   </span><span class="token" style="color:var(--code-token-comment)">#开辟子进程处理数据</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">done</span><span> </span><span class="token operator">&lt;</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;</span><span class="token" style="color:var(--code-token-variable)">${PIPEFILE}</span><span class="token" style="color:var(--code-token-string)">&quot;</span><span>         </span><span class="token" style="color:var(--code-token-comment)">#阻塞的方式等待数据写入</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">done</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">启动服务端：</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/study/shell/share$ bash server.sh 
Server Started ...
</code></div></div>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">客户端</li>
</ul>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token shebang" style="color:#EBCB8B;font-weight:bold">#!/bin/bash</span><span>
</span></span><span style="display:block;padding:0 1.25rem">  
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token assign-left" style="color:var(--code-token-variable)">PIPEFILE</span><span class="token operator">=</span><span>./fifo
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token function-name" style="color:var(--code-token-function)">main</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>   </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;This a message client.&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>   </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;</span><span class="token" style="color:var(--code-token-variable)">$@</span><span class="token" style="color:var(--code-token-string)">&quot;</span><span> </span><span class="token operator">&gt;</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;</span><span class="token" style="color:var(--code-token-variable)">${PIPEFILE}</span><span class="token" style="color:var(--code-token-string)">&quot;</span><span>        </span><span class="token" style="color:var(--code-token-comment)"># 向管道发送数据</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>main </span><span class="token" style="color:var(--code-token-string)">&quot;</span><span class="token" style="color:var(--code-token-variable)">$@</span><span class="token" style="color:var(--code-token-string)">&quot;</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">执行客户端发送消息：
<code>bash client.sh &quot;Name:Jack,Age:22,Gender:Man,Desc:null&quot;</code>
<code>bash client.sh &quot;Name:Jack,Age:22,Gender:Man,Desc:null&quot;</code>
<code>bash client.sh &quot;Name:Lily,Age:21,Gender:Woman,Desc:null&quot;</code></p>
<p class="my-4 leading-7">查看服务端接收消息：</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>[Jack] process here ..

[Tom] process here ..

[Lily] process here ..

</code></div></div>
<h3 id="63-普通文件传递消息" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">6.3 普通文件传递消息<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#63-普通文件传递消息">#</a></h3>
<p class="my-4 leading-7">命名管道采用阻塞的方式实现进程间同步通信，有时，我们也需要进程间异步通信，即两个进程间不需要阻塞的方式等待消息， 它们之间仅仅是传递一个状态或者是标志。
实现异步用一个简单的普通文件就可以了。
比如， A进程需要实现系统IP的配置，B进程需要实现系统IP的修改，但前提是要求系统IP已经配置好，否则就执行失败；</p>
<p class="my-4 leading-7">那么A进程在执行配置IP成功后，可以将状态写入一个约定的配置文件（可以为空文件，仅做标志位，也可以写入状态内容），写完后A进程就不管了；
B进程在执行修改工作时，首先读取配置文件，确认IP配置状态已经成功，然后执行修改过程； 否则可以提示IP尚未配置；</p>
<h2 id="7-进程的远程调用" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">7. 进程的远程调用<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#7-进程的远程调用">#</a></h2>
<p class="my-4 leading-7">实际工作中，经常会遇到远程调用主机上的命令或脚本， 或者将本地脚本同步到远程主机上进行调用。
这里用到ssh(Secure Shell),前提是双方主机建立了通信连接机制，或者密钥的方式或者输入密码方式进行登录执行；</p>
<blockquote class="border-l-2 border-solid border-divider pl-4 my-6 transition-colors duration-500 blockquote_f1063">
<p class="my-4 leading-7">ssh -nq <a href="mailto:user@xxx.xxx.xx.xx" target="_blank" rel="noopener noreferrer" class="link_a7cea  link_a9ef4 inline-link_f855c">user@xxx.xxx.xx.xx</a>  &quot;commoand line&quot;
-n      把 stdin 重定向到 /dev/null (实际上防止从 stdin 读取数据).<br/>
<!-- -->-q      安静模式. 消除所有的警告和诊断信息.
-t      强制分配伪终端.
ssh的详细使用说明可以自行man page</p>
</blockquote>
<h3 id="71-进程执行简单命令" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">7.1 进程执行简单命令<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#71-进程执行简单命令">#</a></h3>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/study/shell/share$ ssh fenglg@192.168.122.39 &quot;uname -a&quot;        
fenglg@192.168.122.39&#x27;s password: 
Linux fenglg 5.4.50-amd64-desktop #74 SMP Mon Aug 24 20:15:37 CST 2020 x86_64 GNU/Linux
test@test-PC:~/work/study/shell/share$ 
</code></div></div>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">ssh连接到远程主机，会进入用户家目录，加载环境变量，所以这里运行的系统命令不需要加绝对路径。</li>
<li class="[&amp;:not(:first-child)]:mt-2">但如果是自己定义的脚本，并且不在家目录下，则需要带上脚本的绝对路径，否则远程shell找不到脚本。</li>
</ul>
<p class="my-4 leading-7"><strong class="font-semibold">Bash登录模式分为登录和非登录，交互和非交互，不同的模式下对环境变量（如/etc/profile,~/.profile, ~/.bashrc,...)加载是不一样的，详细可见man page，这里不做阐述。</strong></p>
<h3 id="72-进程执行多条命令组合" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">7.2 进程执行多条命令组合<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#72-进程执行多条命令组合">#</a></h3>
<p class="my-4 leading-7">如果执行多条命令或者更为复杂的逻辑处理，可以使用Shell Here Document（嵌入文档）的方式。</p>
<p class="my-4 leading-7">应当注意：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">1） 命令从 <code>EOF</code>开始，到遇到下一个<code>EOF</code>结束，注意第二个<code>EOF</code>一定要顶行（行开头，不要留空格或其它字符）书写。</li>
<li class="[&amp;:not(:first-child)]:mt-2">2） 命令中如果包含变量是在远程主机上进行解析，那么本地命令中要加转义’<code>\</code>’，否则会被认为是本地变量，解析后再发送给远程主机。
如下例，两个<code>EOF</code>之间的命令，对于本地主机就是多行字符串，发送到远程主机才会执行，在发送之前，会对<code>${ARCH}</code>变量进行解析，由于<code>ARCH</code>未定义和赋值，这里会被解析成空串发送给远程主机，导致后面命令执行出错。 如果加转义<code>\${ARCH}</code>后本地不再解析，发送到远程主机后命令执行过程中解析。</li>
</ul>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-function)">ssh</span><span> fenglg@192.168.122.39 </span><span class="token operator">&lt;&lt;</span><span> </span><span class="token" style="color:var(--code-token-string)">EOF
</span></span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token">
</span><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-string)">ARCH=</span><span class="token" style="color:var(--code-token-variable)">$(</span><span class="token" style="color:var(--code-token-function)">uname</span><span class="token" style="color:var(--code-token-variable)"> -m</span><span class="token" style="color:var(--code-token-variable)">)</span><span class="token" style="color:var(--code-token-string)">
</span></span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token">echo &quot;--------------------------&quot;
</span><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-string)">echo arch=\</span><span class="token" style="color:var(--code-token-variable)">${ARCH}</span><span class="token" style="color:var(--code-token-string)">
</span></span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token">echo &quot;--------------------------&quot;
</span><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-string)">if [ &quot;\</span><span class="token" style="color:var(--code-token-variable)">${ARCH}</span><span class="token" style="color:var(--code-token-string)">&quot; = x86_64 ]; then
</span></span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token">    dpkg-query -l qemu-user-static
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token">fi
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token">echo &quot;--------------------------&quot;
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token">ifconfig | grep -w inet
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token">
</span><span style="display:block;padding:0 1.25rem;color:var(--code-token-string)" class="token">EOF</span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">输出</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>fenglg@192.168.122.39&#x27;s password: 
请输入密码
验证成功
Welcome to Deepin 20 GNU/Linux
--------------------------
arch=x86_64
--------------------------
dpkg-query: 没有找到与 qemu-user-static 相匹配的软件包
--------------------------
        inet 192.168.122.39  netmask 255.255.255.0  broadcast 192.168.122.255
        inet 192.168.122.237  netmask 255.255.255.0  broadcast 192.168.122.255
        inet 127.0.0.1  netmask 255.0.0.0
</code></div></div>
<h3 id="73-本地脚本远程执行" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">7.3 本地脚本远程执行<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#73-本地脚本远程执行">#</a></h3>
<p class="my-4 leading-7">把上例的命令写入脚本中，这里把变量<code>$</code>符号之前的转义符给去掉，因它不是在作为字符串传递给远程主机了。
<code>vim remote_shell.sh</code></p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token shebang" style="color:#EBCB8B;font-weight:bold">#!/bin/bash</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token assign-left" style="color:var(--code-token-variable)">ARCH</span><span class="token operator">=</span><span class="token" style="color:var(--code-token-variable)">$(</span><span class="token" style="color:var(--code-token-function)">uname</span><span class="token" style="color:var(--code-token-variable)"> -m</span><span class="token" style="color:var(--code-token-variable)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;--------------------------&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token assign-left" style="color:var(--code-token-variable)">arch</span><span class="token operator">=</span><span class="token" style="color:var(--code-token-variable)">${ARCH}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;--------------------------&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">if</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">[</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;</span><span class="token" style="color:var(--code-token-variable)">${ARCH}</span><span class="token" style="color:var(--code-token-string)">&quot;</span><span> </span><span class="token operator">=</span><span> x86_64 </span><span class="token" style="color:var(--code-token-punctuation)">]</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span> </span><span class="token" style="color:var(--code-token-keyword)">then</span><span>
</span></span><span style="display:block;padding:0 1.25rem">    dpkg-query -l qemu-user-static
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">fi</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;--------------------------&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-function)">ifconfig</span><span> </span><span class="token operator">|</span><span> </span><span class="token" style="color:var(--code-token-function)">grep</span><span> -w inet</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">把本地脚本拷贝到远程目录下，再通过ssh远程执行。</li>
</ul>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>test@test-PC:~/work/study/shell/share$ </span><span class="token" style="color:var(--code-token-function)">scp</span><span> remote_shell.sh  fenglg@192.168.122.39:/home/fenglg/
</span></span><span style="display:block;padding:0 1.25rem">fenglg@192.168.122.39&#x27;s password: 
</span><span style="display:block;padding:0 1.25rem"><span>remote_shell.sh                                                        </span><span class="token number">100</span><span>%  </span><span class="token number">244</span><span>    </span><span class="token number">85</span><span>.0KB/s   00:00  
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-function)">ssh</span><span> -nq fenglg@192.168.122.39 </span><span class="token" style="color:var(--code-token-string)">&quot;bash -l /home/fenglg/remote_shell.sh&quot;</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">输出：</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>fenglg@192.168.122.39&#x27;s password: 
</span></span><span style="display:block;padding:0 1.25rem">--------------------------
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token assign-left" style="color:var(--code-token-variable)">arch</span><span class="token operator">=</span><span>x86_64
</span></span><span style="display:block;padding:0 1.25rem">--------------------------
</span><span style="display:block;padding:0 1.25rem">dpkg-query: 没有找到与 qemu-user-static 相匹配的软件包
</span><span style="display:block;padding:0 1.25rem">--------------------------
</span><span style="display:block;padding:0 1.25rem"><span>        inet </span><span class="token number">192.168</span><span>.122.39  netmask </span><span class="token number">255.255</span><span>.255.0  broadcast </span><span class="token number">192.168</span><span>.122.255
</span></span><span style="display:block;padding:0 1.25rem"><span>        inet </span><span class="token number">192.168</span><span>.122.237  netmask </span><span class="token number">255.255</span><span>.255.0  broadcast </span><span class="token number">192.168</span><span>.122.255
</span></span><span style="display:block;padding:0 1.25rem"><span>        inet </span><span class="token number">127.0</span><span>.0.1  netmask </span><span class="token number">255.0</span><span>.0.0</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">通过标准输入重定向的方式将命令传递到远程执行</li>
</ul>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/study/shell/share$ ssh fenglg@192.168.122.39  &lt; remote_shell.sh 
</code></div></div>
<p class="my-4 leading-7">输出与上例是一致的，用此方法可以省去将脚本拷贝到远程主机这一步骤。</p>
<h2 id="8-信号处理" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">8. 信号处理<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#8-信号处理">#</a></h2>
<h3 id="81-linux信号" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">8.1 Linux信号<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#81-linux信号">#</a></h3>
<p class="my-4 leading-7">使用<code>kill -l</code>可以查看当前系统支持的信号列表。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>test@test-PC:~/work/study/shell/share$ kill -l
 1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL       5) SIGTRAP
 6) SIGABRT      7) SIGBUS       8) SIGFPE       9) SIGKILL     10) SIGUSR1
11) SIGSEGV     12) SIGUSR2     13) SIGPIPE     14) SIGALRM     15) SIGTERM
16) SIGSTKFLT   17) SIGCHLD     18) SIGCONT     19) SIGSTOP     20) SIGTSTP
21) SIGTTIN     22) SIGTTOU     23) SIGURG      24) SIGXCPU     25) SIGXFSZ
26) SIGVTALRM   27) SIGPROF     28) SIGWINCH    29) SIGIO       30) SIGPWR
31) SIGSYS      34) SIGRTMIN    35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3
38) SIGRTMIN+4  39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8
43) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12 47) SIGRTMIN+13
48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14 51) SIGRTMAX-13 52) SIGRTMAX-12
53) SIGRTMAX-11 54) SIGRTMAX-10 55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7
58) SIGRTMAX-6  59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2
63) SIGRTMAX-1  64) SIGRTMAX
</code></div></div>
<p class="my-4 leading-7">其中最常用的是</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>SIGHUP  1      控制终端发现被挂起或控制进程死亡，缺省动作为进程终止。
SIGINT  2      键盘终端中断，一般是`CTRL+C`，缺省动作为进程终止。
SIGQUIT 3      来自键盘的退出信号，一般是`CTRL+\`，缺省动作为进程终止。
SIGKILL 9      杀死进程的信号,缺省动作为进程终止,该信号不能捕捉也不能忽略。
SIGUSR1 10     用户自定义信号，缺省动作为进程终止。
SIGALRM 14     定时时钟中断，缺省动作为进程终止。
SIGTERM 15     终止信号，缺省动作为进程终止。
SIGSTP  20     停止进程，一般是`CTRL+Z`，缺省动作为进程终止，但终止还可恢复。
</code></div></div>
<p class="my-4 leading-7">进程可以通过三种方式来响应一个信号：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">1）缺省操作，Linux对每种信号都规定了默认行为，一般是中断进程。</li>
<li class="[&amp;:not(:first-child)]:mt-2">2）捕捉信号，自定义函数进行处理。</li>
<li class="[&amp;:not(:first-child)]:mt-2">3）忽略信号，即对信号不做任何处理，其中有两个信号不能忽略：<code>SIGKILL</code>及<code>SIGSTOP</code>。</li>
</ul>
<h3 id="82-信号的发送和接收" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">8.2 信号的发送和接收<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#82-信号的发送和接收">#</a></h3>
<p class="my-4 leading-7">信号的来源是多样化的，通过<code>kill -l</code>查看信号名称大概可以看到有来源于键盘，有来源于电源，有来源于时钟等等，信号的接收是默认状态的，对于信号的处理linux也规定了默认动作。
在程序本身中，我们也可以自定义发送和捕捉信号，自定义处理捕捉后的行为。</p>
<h4 id="821-trap-捕捉信号" class="mt-8 leading-6 text-lg title_fb7eb">8.2.1 <code>trap</code> 捕捉信号。<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#821-trap-捕捉信号">#</a></h4>
<p class="my-4 leading-7"><code>trap</code>用于捕捉信号</p>
<p class="my-4 leading-7">用法： <code>trap [-lp] [[arg] sigspec ...]</code></p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>trap &quot;commands&quot; signals</code>
捕捉到<code>signals</code>，执行<code>commands</code>，<code>signals</code>是信号列表，多个信号用空格分开。<code>commands</code>可以是一条Linux指定，也可以是自定义的函数。
如下示例，<code>trap</code>捕捉<code>INT</code>,<code>HUP</code>,<code>QUIT</code>三个信号，捕捉到后打印<code>Catch Ctrl+C,QUIT!</code>，然后执行<code>exit</code>退出进程。</p>
<p class="my-4 leading-7"><code>test@test-PC:~/work/study/shell/share$ vi trap1.sh</code></p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token shebang" style="color:#EBCB8B;font-weight:bold">#!/bin/bash</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">trap</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;echo &#x27;Catch SIGNAL,quit!&#x27;; exit 0&quot;</span><span> INT HUP QUIT
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token function-name" style="color:var(--code-token-function)">process_function</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;Program is processing here&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">1</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;[</span><span class="token" style="color:var(--code-token-variable)">$$</span><span class="token" style="color:var(--code-token-string)">]main process is running ..&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">for</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">((</span><span class="token" style="color:var(--code-token-variable)"> i</span><span class="token operator" style="color:var(--code-token-variable)">=</span><span class="token number" style="color:var(--code-token-variable)">0</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span class="token" style="color:var(--code-token-variable)"> i</span><span class="token operator" style="color:var(--code-token-variable)">&lt;</span><span class="token number" style="color:var(--code-token-variable)">5</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span class="token" style="color:var(--code-token-variable)"> i</span><span class="token operator" style="color:var(--code-token-variable)">++</span><span class="token" style="color:var(--code-token-punctuation)">))</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">do</span><span>
</span></span><span style="display:block;padding:0 1.25rem">    process_function
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">done</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><code>trap</code>捕捉后的处理是采用了<code>echo</code>和<code>exit</code>两个指令组合，也可以改为在自定义函数中处理。如下,定义<code>catch_singal</code>来替换<code>commands</code>指定，在函数中可以做更复杂的处理过程。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token shebang" style="color:#EBCB8B;font-weight:bold">#!/bin/bash</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">trap</span><span> catch_singal INT HUP QUIT
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token function-name" style="color:var(--code-token-function)">catch_singal</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&#x27;echo Catch SIGNAL,quit!&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">exit</span><span> </span><span class="token number">0</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token function-name" style="color:var(--code-token-function)">process_function</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;Program is processing here&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">1</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;[</span><span class="token" style="color:var(--code-token-variable)">$$</span><span class="token" style="color:var(--code-token-string)">]main process is running ..&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">for</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">((</span><span class="token" style="color:var(--code-token-variable)"> i</span><span class="token operator" style="color:var(--code-token-variable)">=</span><span class="token number" style="color:var(--code-token-variable)">0</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span class="token" style="color:var(--code-token-variable)"> i</span><span class="token operator" style="color:var(--code-token-variable)">&lt;</span><span class="token number" style="color:var(--code-token-variable)">5</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span class="token" style="color:var(--code-token-variable)"> i</span><span class="token operator" style="color:var(--code-token-variable)">++</span><span class="token" style="color:var(--code-token-punctuation)">))</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">do</span><span>
</span></span><span style="display:block;padding:0 1.25rem">    process_function
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">done</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">在上述脚本执行过程中，按下键盘<code>Ctrl</code>+<code>Z</code>，或者执行<code>kill -1 &lt;PID&gt;</code>或者<code>kill -3 &lt;PID&gt;</code>发送信号， 脚本捕捉到信号后做出处理。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>test@test-PC:~/work/study/shell/share$ </span><span class="token" style="color:var(--code-token-function)">bash</span><span> trap1.sh
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token number">4007</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span>main process is running </span><span class="token" style="color:var(--code-token-punctuation)">..</span><span>
</span></span><span style="display:block;padding:0 1.25rem">Program is processing here
</span><span style="display:block;padding:0 1.25rem">Program is processing here
</span><span style="display:block;padding:0 1.25rem"><span>^CCatch SIGNAL,quit</span><span class="token operator">!</span><span>
</span></span><span style="display:block;padding:0 1.25rem">test@test-PC:~/work/study/shell/share$</span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>trap &quot;&quot; signals</code>: 忽略信号signals，即捕捉到信号，不做处理，屏蔽掉缺省的行为。<strong class="font-semibold">注意：<code>SIGKILL</code>,<code>SIGSTOP</code>不能被忽略，缺省的操作必定执行。</strong>
仍然用上例，</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token shebang" style="color:#EBCB8B;font-weight:bold">#!/bin/bash</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">trap</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;&quot;</span><span> INT HUP QUIT
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token function-name" style="color:var(--code-token-function)">process_function</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;Program is processing here&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">1</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;[</span><span class="token" style="color:var(--code-token-variable)">$$</span><span class="token" style="color:var(--code-token-string)">]main process is running ..&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">for</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">((</span><span class="token" style="color:var(--code-token-variable)"> i</span><span class="token operator" style="color:var(--code-token-variable)">=</span><span class="token number" style="color:var(--code-token-variable)">0</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span class="token" style="color:var(--code-token-variable)"> i</span><span class="token operator" style="color:var(--code-token-variable)">&lt;</span><span class="token number" style="color:var(--code-token-variable)">5</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span class="token" style="color:var(--code-token-variable)"> i</span><span class="token operator" style="color:var(--code-token-variable)">++</span><span class="token" style="color:var(--code-token-punctuation)">))</span><span> 
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">do</span><span>
</span></span><span style="display:block;padding:0 1.25rem">    process_function
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">done</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">任凭如何按<code>Ctrl</code>+<code>C</code>，进程都要执行完毕才退出。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token number">6712</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span>main process is running </span><span class="token" style="color:var(--code-token-punctuation)">..</span><span>
</span></span><span style="display:block;padding:0 1.25rem">Program is processing here
</span><span style="display:block;padding:0 1.25rem">^C^C^CProgram is processing here
</span><span style="display:block;padding:0 1.25rem">^C^C^C^C^CProgram is processing here
</span><span style="display:block;padding:0 1.25rem">^C^C^CProgram is processing here
</span><span style="display:block;padding:0 1.25rem">^C^CProgram is processing here
</span><span style="display:block;padding:0 1.25rem">test@test-PC:~/work/study/shell/share$ ^C
</span><span style="display:block;padding:0 1.25rem">test@test-PC:~/work/study/shell/share$ ^C</span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">当然，你也可以在<code>trap &quot;&quot;</code>的打印一段信息，表示已接收到信号，如<code>trap &quot;echo &#x27;Catch Ctrl+C,but ignore it.&#x27;&quot; INT HUP QUIT</code>，然后再次执行，进程接收到了键盘中断信号，但是不鸟它，就是这么豪横。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>test@test-PC:~/work/study/shell/share$ </span><span class="token" style="color:var(--code-token-function)">bash</span><span> trap2.sh 
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token number">7599</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span>main process is running </span><span class="token" style="color:var(--code-token-punctuation)">..</span><span>
</span></span><span style="display:block;padding:0 1.25rem">Program is processing here
</span><span style="display:block;padding:0 1.25rem">^CCatch Ctrl+C,but ignore it.
</span><span style="display:block;padding:0 1.25rem">Program is processing here
</span><span style="display:block;padding:0 1.25rem">Program is processing here
</span><span style="display:block;padding:0 1.25rem">^CCatch Ctrl+C,but ignore it.
</span><span style="display:block;padding:0 1.25rem">Program is processing here
</span><span style="display:block;padding:0 1.25rem">^CCatch Ctrl+C,but ignore it.
</span><span style="display:block;padding:0 1.25rem">Program is processing here
</span><span style="display:block;padding:0 1.25rem">test@test-PC:~/work/study/shell/share$ ^C</span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>trap signals</code>: 恢复信号的默认行为。
信号可以在进程的开头部分进行忽略，保证进程的关键操作能够不受影响得以完成，也可以中间部分恢复信号的默认行为，保证进程能够正常接收处理信号 。
<code>test@test-PC:~/work/study/shell/share$ vi trap3.sh </code></p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token shebang" style="color:#EBCB8B;font-weight:bold">#!/bin/bash</span><span>
</span></span><span style="display:block;padding:0 1.25rem">  
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">trap</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;echo &#x27;Catch Ctrl+C,but ignore it.&#x27;&quot;</span><span> INT
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;[1]main process is running ..&quot;</span><span> </span><span class="token operator">&amp;&amp;</span><span> </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">1</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;[2]main process is running ..&quot;</span><span> </span><span class="token operator">&amp;&amp;</span><span> </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">1</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;[3]main process is running ..&quot;</span><span> </span><span class="token operator">&amp;&amp;</span><span> </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">1</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">trap</span><span> INT
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;[4]main process is running ..&quot;</span><span> </span><span class="token operator">&amp;&amp;</span><span> </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">1</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;[5]main process is running ..&quot;</span><span> </span><span class="token operator">&amp;&amp;</span><span> </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">1</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;[6]main process is running ..&quot;</span><span> </span><span class="token operator">&amp;&amp;</span><span> </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">1</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">执行前三次打印，发送中断信号无效，第四打印，中断信号成功。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>test@test-PC:~/work/study/shell/share$ </span><span class="token" style="color:var(--code-token-function)">bash</span><span> trap3.sh   
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token number">1</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span>main process is running </span><span class="token" style="color:var(--code-token-punctuation)">..</span><span>
</span></span><span style="display:block;padding:0 1.25rem">^CCatch Ctrl+C,but ignore it.
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token number">2</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span>main process is running </span><span class="token" style="color:var(--code-token-punctuation)">..</span><span>
</span></span><span style="display:block;padding:0 1.25rem">^CCatch Ctrl+C,but ignore it.
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token number">3</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span>main process is running </span><span class="token" style="color:var(--code-token-punctuation)">..</span><span>
</span></span><span style="display:block;padding:0 1.25rem">^CCatch Ctrl+C,but ignore it.
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token number">4</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span>main process is running </span><span class="token" style="color:var(--code-token-punctuation)">..</span><span>
</span></span><span style="display:block;padding:0 1.25rem">^C
</span><span style="display:block;padding:0 1.25rem">test@test-PC:~/work/study/shell/share$</span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>trap -p signal</code>: 把当前的trap设置打印出来。</p>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>trap -l</code>:打印系统支持的信号列表。同<code>kill -l</code>。</p>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>trap &quot;commands&quot; EXIT</code>:脚本退出时执行commands指定的命令。</p>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>trap &quot;commands&quot; RETURN</code>:当从shell函数返回、或者使用source命令执行另一个脚本文件时，执行commands指定的命令。</p>
</li>
</ul>
<h4 id="822-kill-发送信号" class="mt-8 leading-6 text-lg title_fb7eb">8.2.2 <code>kill</code> 发送信号。<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#822-kill-发送信号">#</a></h4>
<p class="my-4 leading-7"><code>kill</code>:发送信号
用法 ：<code>kill[-ssignal|-p][-a]pid...</code></p>
<blockquote class="border-l-2 border-solid border-divider pl-4 my-6 transition-colors duration-500 blockquote_f1063">
<p class="my-4 leading-7">-s     指定发送的信号.  信号可以以信号名或数字的方式给定。
-p     指定 kill 只打印命名进程的进程标识 (pid) , 而不应发送给它信号。
-l     打印信号名的列表.这可以在 /usr/include/linux/signal.h 中找到。
pid ...  给 kill 指定一个该发信号的进程列表。</p>
</blockquote>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>kill &lt;signal&gt; &lt;pids&gt;</code>: 发送<code>kill</code>和接收<code>trap</code>信号时，<code>signal</code>可以使用信号名或数字， 信号名可以带前缀<code>SIG</code>,如<code>SIGHUP</code>，也可以不带，如<code>HUP</code>。<code>pids</code>进程ID可为多个，用空格分隔。
最常用的发送<code>SIGKILL</code>信号来杀死进程,通过命令的返回码<code>$?</code>判断是否执行成功，成功则为<code>0</code>，否则失败。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>test@test-PC:~/work/code/rootfs_mate$ </span><span class="token" style="color:var(--code-token-function)">kill</span><span> -9 </span><span class="token number">21291</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>test@test-PC:~/work/code/rootfs_mate$ </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-variable)">$?</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token number">0</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>test@test-PC:~/work/code/rootfs_mate$ </span><span class="token" style="color:var(--code-token-function)">kill</span><span> -9 </span><span class="token number">81291</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>-bash: kill: </span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token number">81291</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> - 没有那个进程
</span></span><span style="display:block;padding:0 1.25rem"><span>test@test-PC:~/work/code/rootfs_mate$ </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-variable)">$?</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token number">1</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>kill pid</code>： <code>kill</code>不带信号名或数字，则发送<code>(15)SIGTERM</code>信号，默认中断进程。</p>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>kill -0 pid</code>: 或<code>kill -EXIT pid</code>，常用于查询进程在后台是否还在运行，通过命令的返回码<code>$?</code>来判断，如果<code>$?</code>为<code>0</code>说明进程还在，否则，进程已经退出。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>test@test-PC:~/work/study/shell/share$ </span><span class="token" style="color:var(--code-token-function)">kill</span><span> -0 </span><span class="token number">31496</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>test@test-PC:~/work/study/shell/share$ </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-variable)">$?</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token number">0</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>test@test-PC:~/work/study/shell/share$ </span><span class="token" style="color:var(--code-token-function)">kill</span><span> -0 </span><span class="token number">51496</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>bash: kill: </span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token number">51496</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> - 没有那个进程
</span></span><span style="display:block;padding:0 1.25rem"><span>test@test-PC:~/work/study/shell/share$ </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-variable)">$?</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token number">1</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
</li>
</ul>
<h3 id="83-进程通过信号通信" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">8.3 进程通过信号通信<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#83-进程通过信号通信">#</a></h3>
<p class="my-4 leading-7">练习信号通信，使用一个自定义信号<code>SIGUSR1</code>来给守护进程增加一个退出机制。通过自定义函数，保证程序做完清理，然后安全的退出。
<code>test@test-PC:~/work/study/shell/share$ vi server.sh  </code></p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token shebang" style="color:#EBCB8B;font-weight:bold">#!/bin/bash</span><span>
</span></span><span style="display:block;padding:0 1.25rem">  
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token assign-left" style="color:var(--code-token-variable)">PIPEFILE</span><span class="token operator">=</span><span>./fifo
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-function)">rm</span><span> </span><span class="token" style="color:var(--code-token-variable)">$PIPEFILE</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-function)">mkfifo</span><span> -m </span><span class="token number">600</span><span> </span><span class="token" style="color:var(--code-token-variable)">${PIPEFILE}</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">trap</span><span> signal_quit USR1    </span><span class="token" style="color:var(--code-token-comment)">#监听USR1信号</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token function-name" style="color:var(--code-token-function)">clean</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>        
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;Clean unuse Env&quot;</span><span>    
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;Clear unuse files&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">1</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span>signal_quit</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>            </span><span class="token" style="color:var(--code-token-comment)">#信号处理函数，接收到USR1信号时做程序的清理动作，然后退出。</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;Catch quit sigal, clean and quit!&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem">    clean
</span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">exit</span><span> </span><span class="token number">0</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token function-name" style="color:var(--code-token-function)">process_line</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;[</span><span class="token" style="color:var(--code-token-variable)">$1</span><span class="token" style="color:var(--code-token-string)">] process here ..&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;[</span><span class="token" style="color:var(--code-token-variable)">$$</span><span class="token" style="color:var(--code-token-string)">]Server Started ...&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">while</span><span> </span><span class="token class-name" style="color:var(--code-token-symbol)">:</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">do</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">while</span><span> </span><span class="token class-name" style="color:var(--code-token-symbol)">read</span><span> line
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">do</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>       </span><span class="token assign-left" style="color:var(--code-token-variable)">name</span><span class="token operator">=</span><span class="token" style="color:var(--code-token-variable)">$(</span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token" style="color:var(--code-token-string)">&quot;</span><span class="token" style="color:var(--code-token-string)">${line}</span><span class="token" style="color:var(--code-token-string)">&quot;</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token operator" style="color:var(--code-token-variable)">|</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token" style="color:var(--code-token-function)">cut</span><span class="token" style="color:var(--code-token-variable)"> -d</span><span class="token" style="color:var(--code-token-string)">&quot;,&quot;</span><span class="token" style="color:var(--code-token-variable)"> -f1 </span><span class="token operator" style="color:var(--code-token-variable)">|</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token" style="color:var(--code-token-function)">sed</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token" style="color:var(--code-token-string)">&#x27;s/Name://g&#x27;</span><span class="token" style="color:var(--code-token-variable)">)</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>       process_line </span><span class="token" style="color:var(--code-token-string)">&quot;</span><span class="token" style="color:var(--code-token-variable)">${name}</span><span class="token" style="color:var(--code-token-string)">&quot;</span><span>  </span><span class="token operator">&amp;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">done</span><span> </span><span class="token operator">&lt;</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;</span><span class="token" style="color:var(--code-token-variable)">${PIPEFILE}</span><span class="token" style="color:var(--code-token-string)">&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">done</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">写一个客户端进程，专门用来安全停止<code>server.sh</code>服务进程。</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token shebang" style="color:#EBCB8B;font-weight:bold">#!/bin/bash</span><span>
</span></span><span style="display:block;padding:0 1.25rem">  
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token assign-left" style="color:var(--code-token-variable)">pid</span><span class="token operator">=</span><span class="token" style="color:var(--code-token-variable)">$(</span><span class="token" style="color:var(--code-token-function)">ps</span><span class="token" style="color:var(--code-token-variable)"> -u fenglg -ef </span><span class="token operator" style="color:var(--code-token-variable)">|</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token" style="color:var(--code-token-function)">grep</span><span class="token" style="color:var(--code-token-variable)"> -w server.sh  </span><span class="token operator" style="color:var(--code-token-variable)">|</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token" style="color:var(--code-token-function)">grep</span><span class="token" style="color:var(--code-token-variable)"> -v -E </span><span class="token" style="color:var(--code-token-string)">&#x27;vi|grep&#x27;</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token operator" style="color:var(--code-token-variable)">|</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token" style="color:var(--code-token-function)">awk</span><span class="token" style="color:var(--code-token-variable)"> </span><span class="token" style="color:var(--code-token-string)">&#x27;{print $2}&#x27;</span><span class="token" style="color:var(--code-token-variable)">)</span><span>     </span><span class="token" style="color:var(--code-token-comment)">#查询到server.sh的进程id</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> -n </span><span class="token" style="color:var(--code-token-string)">&quot;Stopping [</span><span class="token" style="color:var(--code-token-variable)">$pid</span><span class="token" style="color:var(--code-token-string)">][server.sh] ...&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">if</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">[</span><span> x</span><span class="token" style="color:var(--code-token-string)">&quot;</span><span class="token" style="color:var(--code-token-variable)">${pid}</span><span class="token" style="color:var(--code-token-string)">&quot;</span><span> </span><span class="token operator">!=</span><span> x </span><span class="token" style="color:var(--code-token-punctuation)">]</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span class="token" style="color:var(--code-token-keyword)">then</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">for</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">((</span><span class="token" style="color:var(--code-token-variable)"> i</span><span class="token operator" style="color:var(--code-token-variable)">=</span><span class="token number" style="color:var(--code-token-variable)">1</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span class="token" style="color:var(--code-token-variable)"> i</span><span class="token operator" style="color:var(--code-token-variable)">&lt;=</span><span class="token number" style="color:var(--code-token-variable)">3</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span class="token" style="color:var(--code-token-variable)"> i</span><span class="token operator" style="color:var(--code-token-variable)">++</span><span class="token" style="color:var(--code-token-punctuation)">))</span><span>      </span><span class="token" style="color:var(--code-token-comment)">#安全退出时间限制为3秒，3秒后如未退出，则强制杀死</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">do</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>        </span><span class="token" style="color:var(--code-token-function)">kill</span><span> -EXIT </span><span class="token" style="color:var(--code-token-variable)">${pid}</span><span> </span><span class="token operator">&amp;&gt;</span><span>/dev/null  </span><span class="token" style="color:var(--code-token-comment)">#查询进程是否退出</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>        </span><span class="token" style="color:var(--code-token-keyword)">if</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">[</span><span> </span><span class="token" style="color:var(--code-token-variable)">$?</span><span> -eq </span><span class="token number">0</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">]</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span class="token" style="color:var(--code-token-keyword)">then</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>            </span><span class="token" style="color:var(--code-token-function)">kill</span><span> -USR1 </span><span class="token" style="color:var(--code-token-variable)">${pid}</span><span>  </span><span class="token operator">&amp;&gt;</span><span>/dev/null   </span><span class="token" style="color:var(--code-token-comment)">#发送信号给server.sh</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>            </span><span class="token" style="color:var(--code-token-function)">sleep</span><span> </span><span class="token number">1</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>        </span><span class="token" style="color:var(--code-token-keyword)">else</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>            </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;  [OK]&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>            </span><span class="token class-name" style="color:var(--code-token-symbol)">exit</span><span> </span><span class="token number">0</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>        </span><span class="token" style="color:var(--code-token-keyword)">fi</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">done</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-function)">kill</span><span> -KILL </span><span class="token" style="color:var(--code-token-variable)">${pid}</span><span>     </span><span class="token" style="color:var(--code-token-comment)">#3秒后还未退出，强制杀死进程（补充不安全退出）</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;  [OK]&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">else</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token class-name" style="color:var(--code-token-symbol)">echo</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;server.sh already exited!&quot;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">fi</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token class-name" style="color:var(--code-token-symbol)">exit</span><span> </span><span class="token number">0</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><code>stopserver.sh</code>执行结果：</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>test@test-PC:~/work/code/rootfs_mate$ </span><span class="token" style="color:var(--code-token-function)">bash</span><span> stopserver.sh 
</span></span><span style="display:block;padding:0 1.25rem"><span>Stopping </span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token number">2563</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span class="token" style="color:var(--code-token-punctuation)">[</span><span>server.sh</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">..</span><span>.  </span><span class="token" style="color:var(--code-token-punctuation)">[</span><span>OK</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span>
</span></span><span style="display:block;padding:0 1.25rem">test@test-PC:~/work/code/rootfs_mate$</span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><code>server.sh</code>执行结果：</p>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-bash" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>test@test-PC:~/work/study/shell/share$ </span><span class="token" style="color:var(--code-token-function)">bash</span><span> server.sh   
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token number">2563</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span>Server Started </span><span class="token" style="color:var(--code-token-punctuation)">..</span><span>.
</span></span><span style="display:block;padding:0 1.25rem"><span>Catch quit sigal, clean and quit</span><span class="token operator">!</span><span>
</span></span><span style="display:block;padding:0 1.25rem">Clean unuse Env
</span><span style="display:block;padding:0 1.25rem">Clear unuse files
</span><span style="display:block;padding:0 1.25rem">test@test-PC:~/work/study/shell/share$</span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div><!--/$--></div><div class="rspress-doc-footer"><footer class="mt-8"><div class="xs:flex pb-5 px-2 justify-end items-center"><div class="flex text-sm text-text-2 leading-6 sm:leading-8 font-medium"><p>最近更新时间<!-- -->: <span>2025/3/19 06:31:23</span></p></div></div><div class="flex flex-col"></div><div class="flex flex-col sm:flex-row sm:justify-around gap-4 pt-6"><div class="prev_c92d1 flex flex-col"><a class="link_a7cea pager-link_e0d2d cursor-pointer" target="" href="/program/Shell/Shell编码规范错误参考手册.html"><span class="desc_dcc01">上一页</span><span class="title_a3acb">Shell编码规范错误参考手册</span></a></div><div class="next_c11be flex flex-col"><a class="link_a7cea pager-link_e0d2d next_ad355 cursor-pointer" target="" href="/program/Shell/Shell风格指南.html"><span class="desc_dcc01">下一页</span><span class="title_a3acb">Shell风格指南</span></a></div></div></footer></div></div><div class="aside-container_bc5fa"><div class="flex flex-col"><div id="aside-container" class="relative text-sm font-medium"><div class="leading-7 block text-sm font-semibold pl-3">本页目录</div><nav class="mt-1"><ul class="relative"><li><a href="#1-进程调用无处不在" title="1. 进程调用无处不在" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">1. 进程调用无处不在</span></a></li><li><a href="#2-脚本的调用" title="2. 脚本的调用" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">2. 脚本的调用</span></a></li><li><a href="#3-进程的后台处理" title="3. 进程的后台处理" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">3. 进程的后台处理</span></a></li><li><a href="#31-进程后台运行" title="3.1 进程后台运行" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">3.1 进程后台运行</span></a></li><li><a href="#32-查询后台进程" title="3.2 查询后台进程" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">3.2 查询后台进程</span></a></li><li><a href="#33-恢复后台进程" title="3.3 恢复后台进程" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">3.3 恢复后台进程</span></a></li><li><a href="#4-守护进程" title="4. 守护进程" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">4. 守护进程</span></a></li><li><a href="#5-进程的并发控制" title="5. 进程的并发控制" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">5. 进程的并发控制</span></a></li><li><a href="#51-一个简单的并发例子" title="5.1 一个简单的并发例子" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">5.1 一个简单的并发例子</span></a></li><li><a href="#52-shell进程的同步机制" title="5.2 Shell进程的同步机制" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">5.2 Shell进程的同步机制</span></a></li><li><a href="#53-多进程并发" title="5.3 多进程并发" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">5.3 多进程并发</span></a></li><li><a href="#6-进程间通信" title="6. 进程间通信" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">6. 进程间通信</span></a></li><li><a href="#61-匿名管道" title="6.1 匿名管道" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">6.1 匿名管道</span></a></li><li><a href="#62-命名管道" title="6.2 命名管道" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">6.2 命名管道</span></a></li><li><a href="#63-普通文件传递消息" title="6.3 普通文件传递消息" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">6.3 普通文件传递消息</span></a></li><li><a href="#7-进程的远程调用" title="7. 进程的远程调用" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">7. 进程的远程调用</span></a></li><li><a href="#71-进程执行简单命令" title="7.1 进程执行简单命令" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">7.1 进程执行简单命令</span></a></li><li><a href="#72-进程执行多条命令组合" title="7.2 进程执行多条命令组合" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">7.2 进程执行多条命令组合</span></a></li><li><a href="#73-本地脚本远程执行" title="7.3 本地脚本远程执行" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">7.3 本地脚本远程执行</span></a></li><li><a href="#8-信号处理" title="8. 信号处理" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">8. 信号处理</span></a></li><li><a href="#81-linux信号" title="8.1 Linux信号" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">8.1 Linux信号</span></a></li><li><a href="#82-信号的发送和接收" title="8.2 信号的发送和接收" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">8.2 信号的发送和接收</span></a></li><li><a href="#821-trap-捕捉信号" title="8.2.1 trap 捕捉信号。" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:24px;font-weight:semibold"><span class="aside-link-text block">8.2.1 <code>trap</code> 捕捉信号。</span></a></li><li><a href="#822-kill-发送信号" title="8.2.2 kill 发送信号。" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:24px;font-weight:semibold"><span class="aside-link-text block">8.2.2 <code>kill</code> 发送信号。</span></a></li><li><a href="#83-进程通过信号通信" title="8.3 进程通过信号通信" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">8.3 进程通过信号通信</span></a></li></ul></nav></div></div></div></div></div></div></section></div>
    <div id="search-container"></div>
  </body>
</html>
